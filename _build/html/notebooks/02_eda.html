
<!DOCTYPE html>


<html lang="es" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>02 - Análisis Exploratorio de Datos (EDA) &#8212; Scoring Crediticio - GiveMeSomeCredit</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=78d55cf8"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/translations.js?v=d190bf04"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/02_eda';</script>
    <link rel="icon" href="../_static/flavicon.jpg"/>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="03 - Modelado: Benchmark" href="03_modelado_benchmark.html" />
    <link rel="prev" title="01 - Proyecto: Scoring crediticio (GiveMeSomeCredit)" href="01_introduction.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="es"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Saltar al contenido principal</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Volver arriba</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Advertencia de versión"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="01_introduction.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/UninorteLogo.png" class="logo__image only-light" alt="Scoring Crediticio - GiveMeSomeCredit - Home"/>
    <script>document.write(`<img src="../_static/UninorteLogo.png" class="logo__image only-dark" alt="Scoring Crediticio - GiveMeSomeCredit - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Búsqueda</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="01_introduction.html">
                    01 - Proyecto: Scoring crediticio (GiveMeSomeCredit)
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">02 - Análisis Exploratorio de Datos (EDA)</a></li>



<li class="toctree-l1"><a class="reference internal" href="03_modelado_benchmark.html">03 - Modelado: Benchmark</a></li>

<li class="toctree-l1"><a class="reference internal" href="04_balanceo_clases.html">04 - Técnicas de Balanceo de Clases</a></li>





<li class="toctree-l1"><a class="reference internal" href="05_optimizacion_computacional.html">05 - Optimización Computacional</a></li>






<li class="toctree-l1"><a class="reference internal" href="06_tuning_hiperparametros.html"><strong>06 — Tuning, Validación e Interpretabilidad</strong></a></li>







<li class="toctree-l1"><a class="reference internal" href="08_conclusion_recomendacion_final.html">Conclusión y Recomendaciones Finales</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/MrSpain2104/credit_scoring_machine_learning" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Repositorio de origen"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/MrSpain2104/credit_scoring_machine_learning/issues/new?title=Issue%20on%20page%20%2Fnotebooks/02_eda.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Abrir un problema"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Descarga esta pagina">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/02_eda.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Descargar archivo fuente"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimir en PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Modo de pantalla completa"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="claro/oscuro" aria-label="claro/oscuro" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>02 - Análisis Exploratorio de Datos (EDA)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenido </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">02 - Análisis Exploratorio de Datos (EDA)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indice-y-estructura-del-eda">Índice y estructura del EDA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#helpers">Helpers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cargamos-los-datasets">Cargamos los datasets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diccionario-de-variables">Diccionario de Variables:</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conteo-y-tratamiento-de-valores-nulos">Conteo y Tratamiento de valores Nulos.</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-outliers-regresion-contra-la-variable-objetivo-e-iqr">Análisis de outliers (regresión contra la variable objetivo e IQR)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-general">Interpretación general</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#distribuciones">Distribuciones</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ratio-de-clases-y-visualizaciones-basicas">Ratio de clases y visualizaciones básicas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#uso-del-credito-vs-probabilidad-de-impago">Uso del crédito vs probabilidad de impago</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numero-de-dependientes-vs-probabilidad-de-impago">Número de Dependientes vs Probabilidad de Impago</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ingreso-mensual-vs-probabilidad-de-impago">Ingreso Mensual vs Probabilidad de Impago</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlacion-y-colinealidad">Correlación y Colinealidad</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#alta-correlacion-entre-variables">Alta Correlación entre Variables</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#solucion-adoptada-seleccion-de-la-caracteristica-mas-predictiva">Solución Adoptada: Selección de la Característica más Predictiva</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-de-la-accion">Resultados de la Acción</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduccion-dimensional-exploratoria-pca-y-opcional-t-sne">Reducción dimensional exploratoria: PCA y (opcional) t-SNE</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-del-analisis-de-componentes-principales-pca">Conclusión del Análisis de Componentes Principales (PCA)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analisis-exploratorio-de-datos-eda">
<h1>02 - Análisis Exploratorio de Datos (EDA)<a class="headerlink" href="#analisis-exploratorio-de-datos-eda" title="Link to this heading">#</a></h1>
<p>En este notebook realizaremos un EDA exhaustivo pensado para el proyecto de scoring crediticio (GiveMeSomeCredit). Contiene: carga de los datasets, resumenes estadísticos, detección de valores faltantes y outliers, análisis de correlaciones y una reducción dimensional exploratoria (PCA / t-SNE).</p>
<section id="indice-y-estructura-del-eda">
<h2>Índice y estructura del EDA<a class="headerlink" href="#indice-y-estructura-del-eda" title="Link to this heading">#</a></h2>
<p>Este notebook está estructurado para seguir una secuencia profesional y reproducible:</p>
<ol class="arabic simple">
<li><p>Carga y revisión general del dataset</p></li>
<li><p>Análisis de valores faltantes y tipos de variables</p></li>
<li><p>Distribuciones y outliers (variables numéricas)</p></li>
<li><p>Distribuciones y frecuencias (variables discretas / categóricas)</p></li>
<li><p>Análisis de correlaciones y colinealidad</p></li>
<li><p>Relaciones con la variable objetivo (<code class="docutils literal notranslate"><span class="pre">SeriousDlqin2yrs</span></code>)</p></li>
<li><p>Conclusiones e insights</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Librerías básicas para el EDA</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">roc_auc_score</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">skew</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">mutual_info_classif</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">,</span> <span class="n">rc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">)})</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="c1"># Asegurar que existan las carpetas reports/data en el proyecto (raíz fija del workspace)</span>
<span class="c1"># para que los artefactos se guarden en C:\MachineLearningPG</span>
<span class="n">ROOT</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\MachineLearningPG&#39;</span>
<span class="n">DATA_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ROOT</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">REPORTS_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ROOT</span><span class="p">,</span> <span class="s1">&#39;reports&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">REPORTS_DIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configuración visual global: paleta sobria (vinotinto)</span>
<span class="n">paleta</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#2b0b26&#39;</span><span class="p">,</span> <span class="s2">&quot;#381723&quot;</span><span class="p">,</span> <span class="s2">&quot;#af0a0a&quot;</span><span class="p">,</span> <span class="s1">&#39;#d97b7b&#39;</span><span class="p">,</span> <span class="s1">&#39;#f2c6c6&#39;</span><span class="p">]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">paleta</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;darkgrid&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titlesize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;legend.fontsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">9</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Estilo global configurado: paleta vinotinto y visuales sobrios&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Estilo global configurado: paleta vinotinto y visuales sobrios
</pre></div>
</div>
</div>
</div>
<section id="helpers">
<h3>Helpers<a class="headerlink" href="#helpers" title="Link to this heading">#</a></h3>
<p>Funciones reutilizables para imputación, detección de outliers y plots ordenados</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">resumen_missing</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">m</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">pct</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">m</span><span class="p">,</span> <span class="n">pct</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;n_missing&#39;</span><span class="p">,</span><span class="s1">&#39;pct_missing&#39;</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">iqr_outliers_counts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">cols</span> <span class="k">if</span> <span class="n">cols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
        <span class="n">q1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
        <span class="n">q3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
        <span class="n">iqr</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">-</span> <span class="n">q1</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">iqr</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">iqr</span>
        <span class="n">out</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(((</span><span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lower</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">clip_or_log</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;log1p&#39;</span><span class="p">,</span> <span class="n">clip_pct</span><span class="o">=</span><span class="mf">0.99</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">method</span><span class="o">==</span><span class="s1">&#39;log1p&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">upper</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">clip_pct</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">upper</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">clip_pct</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">save_fig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">REPORTS_DIR</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Guardada figura en&#39;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Helpers de EDA cargados: resumen_missing, iqr_outliers_counts, clip_or_log, save_fig&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Helpers de EDA cargados: resumen_missing, iqr_outliers_counts, clip_or_log, save_fig
</pre></div>
</div>
</div>
</div>
</section>
<section id="cargamos-los-datasets">
<h3>Cargamos los datasets<a class="headerlink" href="#cargamos-los-datasets" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\MachineLearningPG\Recursos\cs-training.csv&#39;</span>
<span class="n">test_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\MachineLearningPG\Recursos\cs-test.csv&#39;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">train_path</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No se encontró el archivo de entrenamiento en </span><span class="si">{</span><span class="n">train_path</span><span class="si">}</span><span class="s2">. Asegúrate de que existe.&quot;</span><span class="p">)</span>

<span class="n">trainingData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">train_path</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">if</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">test_path</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="n">testData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">test_path</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">testData</span> <span class="o">=</span> <span class="kc">None</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dimensiones train:&#39;</span><span class="p">,</span> <span class="n">trainingData</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">if</span> <span class="n">testData</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dimensiones test:&#39;</span><span class="p">,</span> <span class="n">testData</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dimensiones train: (150000, 11)
Dimensiones test: (101503, 11)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="diccionario-de-variables">
<h2>Diccionario de Variables:<a class="headerlink" href="#diccionario-de-variables" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trainingData</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SeriousDlqin2yrs</th>
      <td>150000.0</td>
      <td>0.066840</td>
      <td>0.249746</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>RevolvingUtilizationOfUnsecuredLines</th>
      <td>150000.0</td>
      <td>6.048438</td>
      <td>249.755371</td>
      <td>0.0</td>
      <td>0.029867</td>
      <td>0.154181</td>
      <td>0.559046</td>
      <td>50708.0</td>
    </tr>
    <tr>
      <th>age</th>
      <td>150000.0</td>
      <td>52.295207</td>
      <td>14.771866</td>
      <td>0.0</td>
      <td>41.000000</td>
      <td>52.000000</td>
      <td>63.000000</td>
      <td>109.0</td>
    </tr>
    <tr>
      <th>NumberOfTime30-59DaysPastDueNotWorse</th>
      <td>150000.0</td>
      <td>0.421033</td>
      <td>4.192781</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>98.0</td>
    </tr>
    <tr>
      <th>DebtRatio</th>
      <td>150000.0</td>
      <td>353.005076</td>
      <td>2037.818523</td>
      <td>0.0</td>
      <td>0.175074</td>
      <td>0.366508</td>
      <td>0.868254</td>
      <td>329664.0</td>
    </tr>
    <tr>
      <th>MonthlyIncome</th>
      <td>120269.0</td>
      <td>6670.221237</td>
      <td>14384.674215</td>
      <td>0.0</td>
      <td>3400.000000</td>
      <td>5400.000000</td>
      <td>8249.000000</td>
      <td>3008750.0</td>
    </tr>
    <tr>
      <th>NumberOfOpenCreditLinesAndLoans</th>
      <td>150000.0</td>
      <td>8.452760</td>
      <td>5.145951</td>
      <td>0.0</td>
      <td>5.000000</td>
      <td>8.000000</td>
      <td>11.000000</td>
      <td>58.0</td>
    </tr>
    <tr>
      <th>NumberOfTimes90DaysLate</th>
      <td>150000.0</td>
      <td>0.265973</td>
      <td>4.169304</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>98.0</td>
    </tr>
    <tr>
      <th>NumberRealEstateLoansOrLines</th>
      <td>150000.0</td>
      <td>1.018240</td>
      <td>1.129771</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>54.0</td>
    </tr>
    <tr>
      <th>NumberOfTime60-89DaysPastDueNotWorse</th>
      <td>150000.0</td>
      <td>0.240387</td>
      <td>4.155179</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>98.0</td>
    </tr>
    <tr>
      <th>NumberOfDependents</th>
      <td>146076.0</td>
      <td>0.757222</td>
      <td>1.115086</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>20.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trainingData</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 150000 entries, 1 to 150000
Data columns (total 11 columns):
 #   Column                                Non-Null Count   Dtype  
---  ------                                --------------   -----  
 0   SeriousDlqin2yrs                      150000 non-null  int64  
 1   RevolvingUtilizationOfUnsecuredLines  150000 non-null  float64
 2   age                                   150000 non-null  int64  
 3   NumberOfTime30-59DaysPastDueNotWorse  150000 non-null  int64  
 4   DebtRatio                             150000 non-null  float64
 5   MonthlyIncome                         120269 non-null  float64
 6   NumberOfOpenCreditLinesAndLoans       150000 non-null  int64  
 7   NumberOfTimes90DaysLate               150000 non-null  int64  
 8   NumberRealEstateLoansOrLines          150000 non-null  int64  
 9   NumberOfTime60-89DaysPastDueNotWorse  150000 non-null  int64  
 10  NumberOfDependents                    146076 non-null  float64
dtypes: float64(4), int64(7)
memory usage: 13.7 MB
</pre></div>
</div>
</div>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Nombre de la Variable</p></th>
<th class="head"><p>Descripción</p></th>
<th class="head"><p>Tipo de Dato</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>SeriousDlqin2yrs</strong></p></td>
<td><p>Indica si la persona ha experimentado 90 días de morosidad o más.</p></td>
<td><p>Booleano (Sí/No)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>RevolvingUtilizationOfUnsecuredLines</strong></p></td>
<td><p>Saldo total en tarjetas de crédito y líneas de crédito personales (excepto bienes raíces y deudas a plazos como préstamos para automóviles) dividido por la suma de los límites de crédito.</p></td>
<td><p>Porcentaje</p></td>
</tr>
<tr class="row-even"><td><p><strong>age</strong></p></td>
<td><p>Edad del prestatario en años.</p></td>
<td><p>Entero</p></td>
</tr>
<tr class="row-odd"><td><p><strong>NumberOfTime30-59DaysPastDueNotWorse</strong></p></td>
<td><p>Número de veces que el prestatario ha tenido un retraso en el pago de 30 a 59 días, pero no peor, en los últimos 2 años.</p></td>
<td><p>Entero</p></td>
</tr>
<tr class="row-even"><td><p><strong>DebtRatio</strong></p></td>
<td><p>Pagos mensuales de deudas, pensión alimenticia y costos de vida, divididos por el ingreso bruto mensual.</p></td>
<td><p>Porcentaje</p></td>
</tr>
<tr class="row-odd"><td><p><strong>MonthlyIncome</strong></p></td>
<td><p>Ingreso mensual.</p></td>
<td><p>Numérico (Real)</p></td>
</tr>
<tr class="row-even"><td><p><strong>NumberOfOpenCreditLinesAndLoans</strong></p></td>
<td><p>Número de préstamos abiertos (como préstamos para automóviles o hipotecas) y líneas de crédito (por ejemplo, tarjetas de crédito).</p></td>
<td><p>Entero</p></td>
</tr>
<tr class="row-odd"><td><p><strong>NumberOfTimes90DaysLate</strong></p></td>
<td><p>Número de veces que el prestatario se ha retrasado 90 días o más en un pago.</p></td>
<td><p>Entero</p></td>
</tr>
<tr class="row-even"><td><p><strong>NumberRealEstateLoansOrLines</strong></p></td>
<td><p>Número de préstamos hipotecarios y de bienes raíces, incluyendo líneas de crédito sobre el valor líquido de la vivienda.</p></td>
<td><p>Entero</p></td>
</tr>
<tr class="row-odd"><td><p><strong>NumberOfTime60-89DaysPastDueNotWorse</strong></p></td>
<td><p>Número de veces que el prestatario ha tenido un retraso en el pago de 60 a 89 días, pero no peor, en los últimos 2 años.</p></td>
<td><p>Entero</p></td>
</tr>
<tr class="row-even"><td><p><strong>NumberOfDependents</strong></p></td>
<td><p>Número de dependientes en la familia, excluyendo al propio prestatario (cónyuge, hijos, etc.).</p></td>
<td><p>Entero</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="conteo-y-tratamiento-de-valores-nulos">
<h1>Conteo y Tratamiento de valores Nulos.<a class="headerlink" href="#conteo-y-tratamiento-de-valores-nulos" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Nulos</span>
<span class="n">missing</span> <span class="o">=</span> <span class="n">trainingData</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">missing</span> <span class="o">=</span> <span class="n">missing</span><span class="p">[</span><span class="n">missing</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">missing_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Valores faltantes&#39;</span><span class="p">:</span> <span class="n">missing</span><span class="p">,</span> <span class="s1">&#39;Porcentaje&#39;</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">missing</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">trainingData</span><span class="p">)})</span>
<span class="n">missing_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Valores faltantes</th>
      <th>Porcentaje</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MonthlyIncome</th>
      <td>29731</td>
      <td>19.820667</td>
    </tr>
    <tr>
      <th>NumberOfDependents</th>
      <td>3924</td>
      <td>2.616000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Hay 150,000 filas y 11 características en nuestros datos.
De los cuales observamos que en las columnas MonthlyIncome y NumberOfDependents hay algunos valores nulos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualización de valores faltantes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">missing_df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;Porcentaje&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Porcentaje de valores faltantes por variable&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a49fd2980d18199abbb4fad1dd79ba9640ba197515b67fd0bcc246b74dc3e9f5.png" src="../_images/a49fd2980d18199abbb4fad1dd79ba9640ba197515b67fd0bcc246b74dc3e9f5.png" />
</div>
</div>
<p>Tratamiento de nulos: en este caso, usaremos la mediana para MonthlyIncome y el valor más frecuente (moda) para NumberOfDependents.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trainingData</span><span class="p">[</span><span class="s1">&#39;MonthlyIncome&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">trainingData</span><span class="p">[</span><span class="s1">&#39;MonthlyIncome&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">trainingData</span><span class="p">[</span><span class="s1">&#39;NumberOfDependents&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Verificamos que ya no hayan nulos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Nulos</span>
<span class="n">missing</span> <span class="o">=</span> <span class="n">trainingData</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">missing</span> <span class="o">=</span> <span class="n">missing</span><span class="p">[</span><span class="n">missing</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">missing_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Valores faltantes&#39;</span><span class="p">:</span> <span class="n">missing</span><span class="p">,</span> <span class="s1">&#39;Porcentaje&#39;</span><span class="p">:</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">missing</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">trainingData</span><span class="p">)})</span>
<span class="n">missing_df</span>
<span class="k">if</span> <span class="n">missing_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables con valores faltantes:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables con valores faltantes:
None
</pre></div>
</div>
</div>
</div>
<section id="analisis-de-outliers-regresion-contra-la-variable-objetivo-e-iqr">
<h2>Análisis de outliers (regresión contra la variable objetivo e IQR)<a class="headerlink" href="#analisis-de-outliers-regresion-contra-la-variable-objetivo-e-iqr" title="Link to this heading">#</a></h2>
<p>Resumen visual y numérico de outliers usando IQR y visualizaciones de regplot (muestreo para no plotear todo el dataset).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Análisis de Outliers (IQR)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8-darkgrid&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s1">&#39;dark:#8B0000&#39;</span><span class="p">)</span> 

<span class="n">num_cols</span> <span class="o">=</span> <span class="n">trainingData</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">iqr_summary</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">:</span>
    <span class="n">q1</span><span class="p">,</span> <span class="n">q3</span> <span class="o">=</span> <span class="n">trainingData</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
    <span class="n">iqr</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">-</span> <span class="n">q1</span>
    <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">iqr</span><span class="p">,</span> <span class="n">q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">iqr</span>
    <span class="n">outliers</span> <span class="o">=</span> <span class="p">((</span><span class="n">trainingData</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">lower</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">trainingData</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">perc</span> <span class="o">=</span> <span class="n">outliers</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">trainingData</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">iqr_summary</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">col</span><span class="p">,</span> <span class="n">outliers</span><span class="p">,</span> <span class="n">perc</span><span class="p">])</span>

<span class="n">iqr_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">iqr_summary</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Variable&#39;</span><span class="p">,</span> <span class="s1">&#39;Outliers&#39;</span><span class="p">,</span> <span class="s1">&#39;%&#39;</span><span class="p">])</span>
<span class="n">iqr_df</span> <span class="o">=</span> <span class="n">iqr_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Outliers&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">iqr_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="c1"># Guardar resumen</span>
<span class="n">out_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">REPORTS_DIR</span><span class="p">,</span> <span class="s1">&#39;outlier_summary_train.csv&#39;</span><span class="p">)</span>
<span class="n">iqr_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;✓ Resumen de outliers guardado en: </span><span class="si">{</span><span class="n">out_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Visualización de las 8 variables más afectadas</span>
<span class="n">top_outliers</span> <span class="o">=</span> <span class="n">iqr_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">8</span><span class="p">)[</span><span class="s1">&#39;Variable&#39;</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">top_outliers</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">trainingData</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#8B0000&#39;</span><span class="p">,</span> <span class="n">fliersize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Variables con mayor número de outliers&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Relaciones con el target</span>
<span class="n">sampled</span> <span class="o">=</span> <span class="n">trainingData</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">6000</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">trainingData</span><span class="p">)),</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">top_outliers</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;SeriousDlqin2yrs&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">sampled</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#5C0000&#39;</span><span class="p">,</span> <span class="s1">&#39;#B22222&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1"> vs SeriousDlqin2yrs&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Error en </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Relación de las variables con más outliers frente al target&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable</th>
      <th>Outliers</th>
      <th>%</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>DebtRatio</td>
      <td>31311</td>
      <td>20.874000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NumberOfTime30-59DaysPastDueNotWorse</td>
      <td>23982</td>
      <td>15.988000</td>
    </tr>
    <tr>
      <th>10</th>
      <td>NumberOfDependents</td>
      <td>13336</td>
      <td>8.890667</td>
    </tr>
    <tr>
      <th>0</th>
      <td>SeriousDlqin2yrs</td>
      <td>10026</td>
      <td>6.684000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>MonthlyIncome</td>
      <td>9149</td>
      <td>6.099333</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NumberOfTimes90DaysLate</td>
      <td>8338</td>
      <td>5.558667</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NumberOfTime60-89DaysPastDueNotWorse</td>
      <td>7604</td>
      <td>5.069333</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NumberOfOpenCreditLinesAndLoans</td>
      <td>3980</td>
      <td>2.653333</td>
    </tr>
    <tr>
      <th>8</th>
      <td>NumberRealEstateLoansOrLines</td>
      <td>793</td>
      <td>0.528667</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RevolvingUtilizationOfUnsecuredLines</td>
      <td>763</td>
      <td>0.508667</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✓ Resumen de outliers guardado en: C:\MachineLearningPG\reports\outlier_summary_train.csv
</pre></div>
</div>
<img alt="../_images/04ede8fed061e5df73390b75a7474bba898071441c5039d62ede939eeac9143e.png" src="../_images/04ede8fed061e5df73390b75a7474bba898071441c5039d62ede939eeac9143e.png" />
<img alt="../_images/b609ba5e75d4e1e6a57ff59937da5920e63a0edd47897701fe674c9bae354df6.png" src="../_images/b609ba5e75d4e1e6a57ff59937da5920e63a0edd47897701fe674c9bae354df6.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="interpretacion-general">
<h1>Interpretación general<a class="headerlink" href="#interpretacion-general" title="Link to this heading">#</a></h1>
<p><strong>Insights sobre outliers y su relación con el target</strong></p>
<ul class="simple">
<li><p>Las variables financieras como <code class="docutils literal notranslate"><span class="pre">DebtRatio</span></code> y <code class="docutils literal notranslate"><span class="pre">MonthlyIncome</span></code> presentan valores extremadamente altos que podrían distorsionar las métricas de los modelos.</p></li>
<li><p>Variables de comportamiento crediticio (<code class="docutils literal notranslate"><span class="pre">NumberOfTimes90DaysLate</span></code>, <code class="docutils literal notranslate"><span class="pre">NumberOfTime60-89DaysPastDueNotWorse</span></code>) muestran valores atípicos elevados y concentraciones cerca de cero, indicando una fuerte asimetría.</p></li>
<li><p>Los individuos con valores altos en estas variables tienden a tener mayor probabilidad de incumplimiento (<code class="docutils literal notranslate"><span class="pre">SeriousDlqin2yrs</span> <span class="pre">=</span> <span class="pre">1</span></code>), lo que sugiere un patrón de riesgo claro.</p></li>
<li><p>La variable <code class="docutils literal notranslate"><span class="pre">NumberOfDependents</span></code> tiene algunos valores atípicos inusualmente altos (&gt;10), posiblemente errores o casos raros que convendría revisar.</p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="distribuciones">
<h1>Distribuciones<a class="headerlink" href="#distribuciones" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">plot_distributions_continuous</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="n">cont_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="o">!=</span> <span class="n">target</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cont_cols</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distribución de </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2"> según </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plot_distributions_continuous</span><span class="p">(</span><span class="n">trainingData</span><span class="p">,</span> <span class="s1">&#39;SeriousDlqin2yrs&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ab943fe93b9cf6904fc65f9b477bd0f40c7827361370022177bd9681750ba7bf.png" src="../_images/ab943fe93b9cf6904fc65f9b477bd0f40c7827361370022177bd9681750ba7bf.png" />
<img alt="../_images/3fea0175920989cbf452080914f611863edeb8ea1aa30d4bf0ce070f69a8dabc.png" src="../_images/3fea0175920989cbf452080914f611863edeb8ea1aa30d4bf0ce070f69a8dabc.png" />
<img alt="../_images/479b5d6c01523e43378b84d99dac836bec01b53452e0e23e1675fc6f5327cd71.png" src="../_images/479b5d6c01523e43378b84d99dac836bec01b53452e0e23e1675fc6f5327cd71.png" />
<img alt="../_images/cc08c24e69f664022dbfd97fcce3cab16b94b86b5142b501e86586f6ebfd8bfe.png" src="../_images/cc08c24e69f664022dbfd97fcce3cab16b94b86b5142b501e86586f6ebfd8bfe.png" />
<img alt="../_images/237d7b482f9487d24190b25589316d84f217c3fd563a7d980950b83f553be634.png" src="../_images/237d7b482f9487d24190b25589316d84f217c3fd563a7d980950b83f553be634.png" />
<img alt="../_images/3d34fc297027bc20140da66ebbcac8123945257e8280fb0e238893fb5309415e.png" src="../_images/3d34fc297027bc20140da66ebbcac8123945257e8280fb0e238893fb5309415e.png" />
<img alt="../_images/e470d916dda1104cd94bdf70daa148e21cd42d9bc75515975cb166c3bac3411c.png" src="../_images/e470d916dda1104cd94bdf70daa148e21cd42d9bc75515975cb166c3bac3411c.png" />
<img alt="../_images/b41571417b897fae1aef7eb07be1241fea08010b6cb760684567434003efc699.png" src="../_images/b41571417b897fae1aef7eb07be1241fea08010b6cb760684567434003efc699.png" />
<img alt="../_images/b32033a4b84c4d43f03c643b6fddf517aae41977ef371a6f86ab0253f8b6cc43.png" src="../_images/b32033a4b84c4d43f03c643b6fddf517aae41977ef371a6f86ab0253f8b6cc43.png" />
<img alt="../_images/84f75529a1e67d91049d0ebb37090ebf1405c599cf940461281c30123390c93d.png" src="../_images/84f75529a1e67d91049d0ebb37090ebf1405c599cf940461281c30123390c93d.png" />
</div>
</div>
<section id="ratio-de-clases-y-visualizaciones-basicas">
<h2>Ratio de clases y visualizaciones básicas<a class="headerlink" href="#ratio-de-clases-y-visualizaciones-basicas" title="Link to this heading">#</a></h2>
<p>Mostrar la proporción de clases (pie y countplot) y guardar la figura en <code class="docutils literal notranslate"><span class="pre">reports/</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estilo moderno</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8-darkgrid&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">paleta</span><span class="p">)</span>

<span class="k">if</span> <span class="s1">&#39;SeriousDlqin2yrs&#39;</span> <span class="ow">in</span> <span class="n">trainingData</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">trainingData</span><span class="p">[</span><span class="s1">&#39;SeriousDlqin2yrs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">trainingData</span><span class="p">)</span>
    <span class="n">percentages</span> <span class="o">=</span> <span class="p">(</span><span class="n">counts</span> <span class="o">/</span> <span class="n">total</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">paleta</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">paleta</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
    <span class="c1"># Crear figura</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">bars</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">counts</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">),</span> <span class="n">counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> 
                    <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">pct</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bars</span><span class="p">,</span> <span class="n">counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">percentages</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">+</span> <span class="n">total</span> <span class="o">*</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_y</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
                 <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="se">\n</span><span class="s1">(</span><span class="si">{</span><span class="n">pct</span><span class="si">}</span><span class="s1">%)&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Número de casos&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;SeriousDlqin2yrs&#39;</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Distribución de Clases&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">spines</span><span class="p">[[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="s1">&#39;right&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">wedges</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">autotexts</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">counts</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">counts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span>
                                   <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">explode</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">],</span>
                                   <span class="n">wedgeprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
                                   <span class="n">textprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">autotext</span> <span class="ow">in</span> <span class="n">autotexts</span><span class="p">:</span> <span class="n">autotext</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Proporción (%)&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]);</span> <span class="n">ax3</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">/</span> <span class="n">counts</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">majority</span><span class="p">,</span> <span class="n">minority</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(),</span> <span class="n">counts</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    
    <span class="n">balance_map</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Fuertemente desbalanceado&#39;</span><span class="p">,</span> <span class="n">paleta</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span>
                   <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Moderadamente desbalanceado&#39;</span><span class="p">,</span> <span class="n">paleta</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
    <span class="n">status</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(((</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">balance_map</span> <span class="k">if</span> <span class="n">ratio</span> <span class="o">&gt;</span> <span class="n">t</span><span class="p">),</span>
                         <span class="p">(</span><span class="s1">&#39;Relativamente balanceado&#39;</span><span class="p">,</span> <span class="n">paleta</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    
    <span class="n">info_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Resumen del Balance</span>

<span class="s2">    Clase Mayoritaria: </span><span class="si">{</span><span class="n">majority</span><span class="si">}</span>
<span class="s2">    • Casos: </span><span class="si">{</span><span class="n">counts</span><span class="p">[</span><span class="n">majority</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span>
<span class="s2">    • Porcentaje: </span><span class="si">{</span><span class="n">percentages</span><span class="p">[</span><span class="n">majority</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%</span>

<span class="s2">    Clase Minoritaria: </span><span class="si">{</span><span class="n">minority</span><span class="si">}</span>
<span class="s2">    • Casos: </span><span class="si">{</span><span class="n">counts</span><span class="p">[</span><span class="n">minority</span><span class="p">]</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span>
<span class="s2">    • Porcentaje: </span><span class="si">{</span><span class="n">percentages</span><span class="p">[</span><span class="n">minority</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%</span>

<span class="s2">    Ratio de Desbalance: </span><span class="si">{</span><span class="n">ratio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">:1</span>
<span class="s2">    Total de registros: </span><span class="si">{</span><span class="n">total</span><span class="si">:</span><span class="s2">,</span><span class="si">}</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">info_text</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax3</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
             <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;wheat&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">),</span>
             <span class="n">family</span><span class="o">=</span><span class="s1">&#39;monospace&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax3</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
             <span class="n">fontsize</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.18</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Análisis de Balance de Clases - Conjunto de Entrenamiento&#39;</span><span class="p">,</span> 
                 <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.98</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">REPORTS_DIR</span><span class="p">,</span> <span class="s1">&#39;imbalance_ratio_train.png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;✓ Figura de ratio de clases guardada en: </span><span class="si">{</span><span class="n">fig_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No se encontró la columna objetivo; se omite la visualización de ratio de clases.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0112bc4bf09e98b98c7d36076fd332d109556bcc45bfcf4d89aef03b986972e9.png" src="../_images/0112bc4bf09e98b98c7d36076fd332d109556bcc45bfcf4d89aef03b986972e9.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✓ Figura de ratio de clases guardada en: C:\MachineLearningPG\reports\imbalance_ratio_train.png
</pre></div>
</div>
</div>
</div>
<section id="uso-del-credito-vs-probabilidad-de-impago">
<h3>Uso del crédito vs probabilidad de impago<a class="headerlink" href="#uso-del-credito-vs-probabilidad-de-impago" title="Link to this heading">#</a></h3>
<p>Este histograma muestra la distribución del uso del crédito y cómo se relaciona con la probabilidad de impago.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hacemos una copia para no modificar el dataframe original</span>
<span class="n">data_filtrada</span> <span class="o">=</span> <span class="n">trainingData</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Filtramos para mantener solo los valores menores o iguales a 1 (100% de utilización)</span>
<span class="n">data_filtrada</span> <span class="o">=</span> <span class="n">data_filtrada</span><span class="p">[</span><span class="n">data_filtrada</span><span class="p">[</span><span class="s1">&#39;RevolvingUtilizationOfUnsecuredLines&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">1.5</span><span class="p">]</span>

<span class="c1"># Creamos el gráfico con los datos filtrados y más bins para mayor detalle</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="c1"># Hacemos el gráfico un poco más grande</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_filtrada</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;RevolvingUtilizationOfUnsecuredLines&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;SeriousDlqin2yrs&#39;</span><span class="p">,</span> 
             <span class="n">multiple</span><span class="o">=</span><span class="s2">&quot;stack&quot;</span><span class="p">,</span> <span class="c1"># Apila las barras para ver mejor la proporción</span>
             <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span> <span class="c1"># Aumentamos el número de bins para ver más detalle</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Uso del crédito (hasta 100%) vs probabilidad de impago&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Uso del Crédito Revolvente&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Conteo&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5926a328713be69fd805b31327ba39fe98f52f2176322cf251d3047175827c18.png" src="../_images/5926a328713be69fd805b31327ba39fe98f52f2176322cf251d3047175827c18.png" />
</div>
</div>
<p>Y el gráfico nos demuestra de forma efectiva que existe una fuerte correlación positiva entre el nivel de utilización del crédito y la probabilidad de incurrir en una morosidad grave.
A medida que te desplazamos de izquierda a derecha en el gráfico (es decir, a medida que aumenta el uso del crédito), la proporción de la barra que corresponde al impago (SeriousDlqin2yrs = 1, el color más rojizo) se hace cada vez más grande.</p>
</section>
<section id="numero-de-dependientes-vs-probabilidad-de-impago">
<h3>Número de Dependientes vs Probabilidad de Impago<a class="headerlink" href="#numero-de-dependientes-vs-probabilidad-de-impago" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;NumberOfDependents&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;SeriousDlqin2yrs&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span> <span class="n">trainingData</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Número de Dependientes vs Probabilidad de Impago&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Número de Dependientes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probabilidad de Impago&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Probabilidad de Impago&#39;)
</pre></div>
</div>
<img alt="../_images/d66e8cd57177517fdd696d653e377b3e6886f17d909a43c850e57e221a37ff76.png" src="../_images/d66e8cd57177517fdd696d653e377b3e6886f17d909a43c850e57e221a37ff76.png" />
</div>
</div>
<p>Tal parece que el número de dependientes puede ser un factor importante para predecir el riesgo de impago. El riesgo tiende a aumentar con el número de personas a cargo, pero alcanza un punto crítico en 6 dependientes, para luego disminuir. Esto podría ser un punto clave para un modelo de riesgo crediticio.</p>
</section>
<section id="ingreso-mensual-vs-probabilidad-de-impago">
<h3>Ingreso Mensual vs Probabilidad de Impago<a class="headerlink" href="#ingreso-mensual-vs-probabilidad-de-impago" title="Link to this heading">#</a></h3>
<p>Este diagrama de cajas (box plot) compara la distribución del ingreso mensual para dos grupos de personas:</p>
<ul class="simple">
<li><p>Grupo 0: Aquellos que no incurrieron en impago en los últimos 2 años.</p></li>
<li><p>Grupo 1: Aquellos que sí incurrieron en impago en los últimos 2 años</p></li>
</ul>
<p>Decidimos cortar en un percentil, escpecificamente el 99%. Esto significa que eliminaremos del gráfico el 1% de las personas con los ingresos más altos para poder ver con mayor claridad la distribución del 99% restante.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filtra los datos para visualizar el 99% de los ingresos</span>
<span class="n">income_limite</span> <span class="o">=</span> <span class="n">trainingData</span><span class="p">[</span><span class="s1">&#39;MonthlyIncome&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.99</span><span class="p">)</span>
<span class="n">data_filtrada</span> <span class="o">=</span> <span class="n">trainingData</span><span class="p">[</span><span class="n">trainingData</span><span class="p">[</span><span class="s1">&#39;MonthlyIncome&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">income_limite</span><span class="p">]</span>

<span class="c1"># Crea el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;SeriousDlqin2yrs&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;MonthlyIncome&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_filtrada</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Ingreso Mensual (99</span><span class="si">% d</span><span class="s2">e los datos) vs Probabilidad de Impago&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Impago en 2 años (0 = No, 1 = Sí)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Ingreso Mensual&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/085810c3349e8d3cbc26d4a6fcfb9585eba40b612614b5f013a5f40af549fe36.png" src="../_images/085810c3349e8d3cbc26d4a6fcfb9585eba40b612614b5f013a5f40af549fe36.png" />
</div>
</div>
<p>Este gráfico confirma de manera efectiva que el ingreso mensual es un indicador importante del riesgo crediticio. Un menor ingreso está asociado con una mayor probabilidad de que una persona enfrente dificultades para cumplir con sus obligaciones de pago.</p>
</section>
<hr class="docutils" />
<section id="correlacion-y-colinealidad">
<h3>Correlación y Colinealidad<a class="headerlink" href="#correlacion-y-colinealidad" title="Link to this heading">#</a></h3>
<p>A continuación, se realizará un análisis para entender las relaciones entre las variables. Primero, se generará una <strong>matriz de correlación</strong> para identificar la multicolinealidad, es decir, la redundancia entre las características predictoras. Inmediatamente después, se calculará la <strong>Información Mutua</strong> para medir la fuerza de la relación (lineal y no lineal) de cada característica con la variable objetivo <code class="docutils literal notranslate"><span class="pre">SeriousDlqin2yrs</span></code>. Este doble análisis es fundamental para seleccionar las variables más predictivas y descartar las redundantes, un paso clave para la construcción de un modelo de machine learning eficaz.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Matriz de Correlación</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="n">trainingData</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">num_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;SeriousDlqin2yrs&#39;</span><span class="p">)</span>

<span class="n">corr</span> <span class="o">=</span> <span class="n">trainingData</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">))</span> <span class="c1"># Máscara para el triángulo superior</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de Correlación entre Características&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Identifica y muestra pares con correlación &gt; 0.7 para revisar multicolinealidad</span>
<span class="n">high_corr</span> <span class="o">=</span> <span class="n">corr</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">high_corr</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Variable 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Variable 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Correlación Absoluta&#39;</span><span class="p">]</span>
<span class="c1"># Elimina la auto-correlación (diagonal)</span>
<span class="n">high_corr</span> <span class="o">=</span> <span class="n">high_corr</span><span class="p">[</span><span class="n">high_corr</span><span class="p">[</span><span class="s1">&#39;Variable 1&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">high_corr</span><span class="p">[</span><span class="s1">&#39;Variable 2&#39;</span><span class="p">]]</span>
<span class="c1"># Ordena y muestra los más altos</span>
<span class="n">high_corr</span> <span class="o">=</span> <span class="n">high_corr</span><span class="p">[</span><span class="n">high_corr</span><span class="p">[</span><span class="s1">&#39;Correlación Absoluta&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.7</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;Correlación Absoluta&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pares de variables con alta correlación (&gt; 0.7):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">high_corr</span><span class="p">)</span>

<span class="c1"># Calcula qué tan informativa es cada variable para predecir &#39;SeriousDlqin2yrs&#39;</span>
<span class="n">X_mi</span> <span class="o">=</span> <span class="n">trainingData</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span>
<span class="n">y_mi</span> <span class="o">=</span> <span class="n">trainingData</span><span class="p">[</span><span class="s1">&#39;SeriousDlqin2yrs&#39;</span><span class="p">]</span>

<span class="n">mi_scores</span> <span class="o">=</span> <span class="n">mutual_info_classif</span><span class="p">(</span><span class="n">X_mi</span><span class="p">,</span> <span class="n">y_mi</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">mi_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi_scores</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X_mi</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Información Mutua de cada característica con la variable objetivo:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">mi_series</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/89b3b3335f3b0a5fcd207e846e6dd43d5aaabd136a845ef3a8dd44fb05479634.png" src="../_images/89b3b3335f3b0a5fcd207e846e6dd43d5aaabd136a845ef3a8dd44fb05479634.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pares de variables con alta correlación (&gt; 0.7):
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variable 1</th>
      <th>Variable 2</th>
      <th>Correlación Absoluta</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>86</th>
      <td>NumberOfTime60-89DaysPastDueNotWorse</td>
      <td>NumberOfTimes90DaysLate</td>
      <td>0.992796</td>
    </tr>
    <tr>
      <th>68</th>
      <td>NumberOfTimes90DaysLate</td>
      <td>NumberOfTime60-89DaysPastDueNotWorse</td>
      <td>0.992796</td>
    </tr>
    <tr>
      <th>82</th>
      <td>NumberOfTime60-89DaysPastDueNotWorse</td>
      <td>NumberOfTime30-59DaysPastDueNotWorse</td>
      <td>0.987005</td>
    </tr>
    <tr>
      <th>28</th>
      <td>NumberOfTime30-59DaysPastDueNotWorse</td>
      <td>NumberOfTime60-89DaysPastDueNotWorse</td>
      <td>0.987005</td>
    </tr>
    <tr>
      <th>26</th>
      <td>NumberOfTime30-59DaysPastDueNotWorse</td>
      <td>NumberOfTimes90DaysLate</td>
      <td>0.983603</td>
    </tr>
    <tr>
      <th>62</th>
      <td>NumberOfTimes90DaysLate</td>
      <td>NumberOfTime30-59DaysPastDueNotWorse</td>
      <td>0.983603</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Información Mutua de cada característica con la variable objetivo:
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RevolvingUtilizationOfUnsecuredLines    0.036152
NumberOfTimes90DaysLate                 0.031424
NumberOfTime30-59DaysPastDueNotWorse    0.026458
NumberOfTime60-89DaysPastDueNotWorse    0.021728
age                                     0.007740
NumberRealEstateLoansOrLines            0.006448
NumberOfOpenCreditLinesAndLoans         0.005830
DebtRatio                               0.004010
MonthlyIncome                           0.003648
NumberOfDependents                      0.003343
dtype: float64
</pre></div>
</div>
</div>
</div>
<section id="alta-correlacion-entre-variables">
<h4>Alta Correlación entre Variables<a class="headerlink" href="#alta-correlacion-entre-variables" title="Link to this heading">#</a></h4>
<p>En el análisis de la matriz de correlación, se identificó un problema de <strong>multicolinealidad</strong> casi perfecta entre las siguientes tres variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NumberOfTime30-59DaysPastDueNotWorse</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NumberOfTime60-89DaysPastDueNotWorse</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NumberOfTimes90DaysLate</span></code></p></li>
</ul>
<p>La correlación entre ellas superaba el <strong>0.98</strong>, lo que indica que son altamente redundantes. Estas variables miden esencialmente el mismo comportamiento subyacente: la tendencia de un cliente a retrasarse en sus pagos.</p>
</section>
<section id="solucion-adoptada-seleccion-de-la-caracteristica-mas-predictiva">
<h4>Solución Adoptada: Selección de la Característica más Predictiva<a class="headerlink" href="#solucion-adoptada-seleccion-de-la-caracteristica-mas-predictiva" title="Link to this heading">#</a></h4>
<p>Para resolver este problema, se decidió adoptar una estrategia de selección de características en lugar de combinarlas. La estrategia consiste en <strong>conservar únicamente la variable que aporte más información predictiva sobre el impago y descartar las otras dos.</strong></p>
<p>Para determinar cuál era la más predictiva, se utilizó el análisis de <strong>Información Mutua</strong>, el cual nos indicó el poder predictivo de cada variable con respecto a nuestro objetivo <code class="docutils literal notranslate"><span class="pre">SeriousDlqin2yrs</span></code>. Aunque las tres variables mostraron una alta capacidad predictiva, se seleccionó <code class="docutils literal notranslate"><span class="pre">NumberOfTimes90DaysLate</span></code> por dos razones clave:</p>
<ol class="arabic simple">
<li><p><strong>Alto Poder Predictivo:</strong> Se encuentra entre las variables con mayor puntuación de Información Mutua.</p></li>
<li><p><strong>Severidad del Indicador:</strong> Un retraso de 90 días o más es, por definición, un indicador de morosidad más grave y, por lo tanto, conceptualmente más fuerte para predecir un impago serio.</p></li>
</ol>
</section>
<section id="resultados-de-la-accion">
<h4>Resultados de la Acción<a class="headerlink" href="#resultados-de-la-accion" title="Link to this heading">#</a></h4>
<p>Como resultado de este análisis, se procederá a modificar el conjunto de datos de la siguiente manera:</p>
<ul class="simple">
<li><p><strong>Variable Conservada:</strong> <code class="docutils literal notranslate"><span class="pre">NumberOfTimes90DaysLate</span></code></p></li>
<li><p><strong>Variables a despreciar:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">NumberOfTime30-59DaysPastDueNotWorse</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NumberOfTime60-89DaysPastDueNotWorse</span></code></p></li>
</ul>
</li>
</ul>
<p>Con esta acción, eliminamos la redundancia de datos, simplificamos el modelo y nos aseguramos de que las variables predictoras sean más independientes entre sí, lo que conducirá a un modelo más robusto e interpretable.</p>
</section>
</section>
</section>
<section id="reduccion-dimensional-exploratoria-pca-y-opcional-t-sne">
<h2>Reducción dimensional exploratoria: PCA y (opcional) t-SNE<a class="headerlink" href="#reduccion-dimensional-exploratoria-pca-y-opcional-t-sne" title="Link to this heading">#</a></h2>
<p>Realizaremos PCA sobre las variables numéricas escaladas y mostraremos los dos primeros componentes. Si se desea, se puede añadir t-SNE en un paso posterior para visualizar estructuras no lineales.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># PCA sobre variables numéricas (tras escalado) - train</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">num_cols</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">trainingData</span><span class="p">[</span><span class="n">num_cols</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>  <span class="c1"># PCA simple: descartar filas con NA en numéricas</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span>
    <span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">Xs</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">comps</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Xs</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
    <span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;SeriousDlqin2yrs&#39;</span>
    <span class="k">if</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">trainingData</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">lab</span> <span class="o">=</span> <span class="n">trainingData</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="n">target</span><span class="p">]</span>  <span class="c1"># alineo etiquetas con X</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">comps</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">comps</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">hue</span><span class="o">=</span><span class="n">lab</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set1&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">target</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">comps</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">comps</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PCA (2 componentes) sobre numéricas - train&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;PC1&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PC2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Varianza explicada por componente:&#39;</span><span class="p">,</span> <span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No hay suficientes columnas numéricas para PCA.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ad187274ca2a4dcb99258514239ecb20f9dafc39ededf7532123e3ab2635b5f5.png" src="../_images/ad187274ca2a4dcb99258514239ecb20f9dafc39ededf7532123e3ab2635b5f5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Varianza explicada por componente: [0.29950034 0.15374301]
</pre></div>
</div>
</div>
</div>
<section id="conclusion-del-analisis-de-componentes-principales-pca">
<h3>Conclusión del Análisis de Componentes Principales (PCA)<a class="headerlink" href="#conclusion-del-analisis-de-componentes-principales-pca" title="Link to this heading">#</a></h3>
<p>Para obtener una visión general de la estructura de los datos, se aplicó un Análisis de Componentes Principales (PCA). El objetivo era reducir la dimensionalidad de todas las características numéricas a solo dos componentes (PC1 y PC2) para visualizar si existía una separación natural entre los clientes que incurren en impago (<code class="docutils literal notranslate"><span class="pre">SeriousDlqin2yrs</span> <span class="pre">=</span> <span class="pre">1</span></code>) y los que no (<code class="docutils literal notranslate"><span class="pre">SeriousDlqin2yrs</span> <span class="pre">=</span> <span class="pre">0</span></code>).</p>
<p><strong>Resultados Clave:</strong></p>
<ol class="arabic simple">
<li><p><strong>Varianza Explicada Limitada:</strong> Los resultados numéricos mostraron que los dos componentes principales capturan una porción limitada de la información total.</p>
<ul class="simple">
<li><p><strong>PC1 (eje X):</strong> Explica el <strong>29.9%</strong> de la varianza.</p></li>
<li><p><strong>PC2 (eje Y):</strong> Explica el <strong>15.4%</strong> de la varianza.
En conjunto, esto significa que esta visualización 2D solo representa el <strong>45% de la información total</strong> contenida en los datos. La complejidad del problema no puede ser simplificada a solo dos dimensiones.</p></li>
</ul>
</li>
<li><p><strong>Falta de Separabilidad Lineal:</strong> El gráfico de dispersión muestra una <strong>fuerte superposición</strong> entre las dos clases. Los puntos que representan a los clientes que incurrieron en impago (en azul) y los que no (en rojo) están en su mayoría mezclados, sin una frontera clara que los separe.</p></li>
</ol>
<p><strong>Conclusión Final:</strong></p>
<p>La principal conclusión de este análisis es que la distinción entre los clientes que pagan a tiempo y los que no, es sutil y compleja. <strong>No existe una combinación lineal simple de las características que pueda separar eficazmente las dos clases</strong>. Esto refuerza la necesidad de utilizar modelos de machine learning capaces de capturar relaciones no lineales y subraya la importancia de la selección de características individuales, como se vio previamente con la Información Mutua.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="01_introduction.html"
       title="página anterior">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">anterior</p>
        <p class="prev-next-title">01 - Proyecto: Scoring crediticio (GiveMeSomeCredit)</p>
      </div>
    </a>
    <a class="right-next"
       href="03_modelado_benchmark.html"
       title="siguiente página">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">siguiente</p>
        <p class="prev-next-title">03 - Modelado: Benchmark</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenido
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">02 - Análisis Exploratorio de Datos (EDA)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indice-y-estructura-del-eda">Índice y estructura del EDA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#helpers">Helpers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cargamos-los-datasets">Cargamos los datasets</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diccionario-de-variables">Diccionario de Variables:</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conteo-y-tratamiento-de-valores-nulos">Conteo y Tratamiento de valores Nulos.</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-outliers-regresion-contra-la-variable-objetivo-e-iqr">Análisis de outliers (regresión contra la variable objetivo e IQR)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-general">Interpretación general</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#distribuciones">Distribuciones</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ratio-de-clases-y-visualizaciones-basicas">Ratio de clases y visualizaciones básicas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#uso-del-credito-vs-probabilidad-de-impago">Uso del crédito vs probabilidad de impago</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numero-de-dependientes-vs-probabilidad-de-impago">Número de Dependientes vs Probabilidad de Impago</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ingreso-mensual-vs-probabilidad-de-impago">Ingreso Mensual vs Probabilidad de Impago</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlacion-y-colinealidad">Correlación y Colinealidad</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#alta-correlacion-entre-variables">Alta Correlación entre Variables</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#solucion-adoptada-seleccion-de-la-caracteristica-mas-predictiva">Solución Adoptada: Selección de la Característica más Predictiva</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados-de-la-accion">Resultados de la Acción</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduccion-dimensional-exploratoria-pca-y-opcional-t-sne">Reducción dimensional exploratoria: PCA y (opcional) t-SNE</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-del-analisis-de-componentes-principales-pca">Conclusión del Análisis de Componentes Principales (PCA)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Por Andrés España | Omar Medina
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  © 2025 Andrés España | Universidad del Norte
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>