
<!DOCTYPE html>


<html lang="es" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>05 - Optimización Computacional &#8212; Scoring Crediticio - GiveMeSomeCredit</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=78d55cf8"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/translations.js?v=d190bf04"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/05_optimizacion_computacional';</script>
    <link rel="icon" href="../_static/flavicon.jpg"/>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="06 — Tuning, Validación e Interpretabilidad" href="06_tuning_hiperparametros.html" />
    <link rel="prev" title="04 - Técnicas de Balanceo de Clases" href="04_balanceo_clases.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="es"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Saltar al contenido principal</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Volver arriba</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Advertencia de versión"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="01_introduction.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/UninorteLogo.png" class="logo__image only-light" alt="Scoring Crediticio - GiveMeSomeCredit - Home"/>
    <script>document.write(`<img src="../_static/UninorteLogo.png" class="logo__image only-dark" alt="Scoring Crediticio - GiveMeSomeCredit - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Búsqueda</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="01_introduction.html">
                    01 - Proyecto: Scoring crediticio (GiveMeSomeCredit)
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="02_eda.html">02 - Análisis Exploratorio de Datos (EDA)</a></li>



<li class="toctree-l1"><a class="reference internal" href="03_modelado_benchmark.html">03 - Modelado: Benchmark</a></li>

<li class="toctree-l1"><a class="reference internal" href="04_balanceo_clases.html">04 - Técnicas de Balanceo de Clases</a></li>





<li class="toctree-l1 current active"><a class="current reference internal" href="#">05 - Optimización Computacional</a></li>






<li class="toctree-l1"><a class="reference internal" href="06_tuning_hiperparametros.html"><strong>06 — Tuning, Validación e Interpretabilidad</strong></a></li>







<li class="toctree-l1"><a class="reference internal" href="08_conclusion_recomendacion_final.html">Conclusión y Recomendaciones Finales</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/MrSpain2104/credit_scoring_machine_learning" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Repositorio de origen"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/MrSpain2104/credit_scoring_machine_learning/issues/new?title=Issue%20on%20page%20%2Fnotebooks/05_optimizacion_computacional.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Abrir un problema"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Descarga esta pagina">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/05_optimizacion_computacional.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Descargar archivo fuente"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimir en PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Modo de pantalla completa"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="claro/oscuro" aria-label="claro/oscuro" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>05 - Optimización Computacional</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenido </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">05 - Optimización Computacional</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-y-carga-de-datos">Setup y Carga de Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ejecucion-de-pruebas">Ejecución de Pruebas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#capacidades-de-la-funcion-evaluate-model">Capacidades de la Función <code class="docutils literal notranslate"><span class="pre">evaluate_model</span></code>:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#seccion-1-optimizacion-de-modelos-lineales-logistic-regression">Sección 1: Optimización de Modelos Lineales (Logistic Regression)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objetivo">Objetivo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hipotesis">Hipótesis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experimentos">Experimentos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-de-la-seccion-1-optimizacion-de-solvers-en-regresion-logistica">Conclusión de la Sección 1: Optimización de Solvers en Regresión Logística</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hallazgos-clave">Hallazgos Clave:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-e-interpretacion-el-overhead-de-la-escalabilidad">Análisis e Interpretación: El «Overhead» de la Escalabilidad</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#veredicto-final-de-la-seccion">Veredicto Final de la Sección</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#seccion-2-optimizacion-de-xgboost">Sección 2: Optimización de XGBoost</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tecnicas">Técnicas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Hipótesis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Experimentos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-y-conclusion-de-la-seccion-2-optimizacion-de-xgboost">Análisis y Conclusión de la Sección 2: Optimización de XGBoost</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Hallazgos Clave:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Veredicto Final de la Sección</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#seccion-3-optimizacion-de-k-nearest-neighbors-knn">Sección 3: Optimización de K-Nearest Neighbors (KNN)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hipotesis-la-maldicion-de-la-dimensionalidad">Hipótesis: La Maldición de la Dimensionalidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Experimentos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-de-la-seccion-3-el-impacto-de-la-dimensionalidad-en-knn">Conclusión de la Sección 3: El Impacto de la Dimensionalidad en KNN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Hallazgos Clave:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Veredicto Final de la Sección</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experimento-adicional-mitigando-la-maldicion-de-la-dimensionalidad-con-pca-knn">Experimento Adicional: Mitigando la Maldición de la Dimensionalidad con PCA + KNN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Hipótesis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodologia">Metodología</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-del-experimento-adicional-pca-knn">Conclusión del Experimento Adicional: PCA + KNN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#veredicto-final-del-experimento">Veredicto Final del Experimento</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#seccion-4-optimizacion-de-naive-bayes-con-entrenamiento-incremental-partial-fit">Sección 4: Optimización de Naive Bayes con Entrenamiento Incremental (<code class="docutils literal notranslate"><span class="pre">partial_fit</span></code>)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objetivo-y-relevancia">Objetivo y Relevancia</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Hipótesis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Experimentos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-de-la-seccion-4-entrenamiento-incremental-con-naive-bayes">Conclusión de la Sección 4: Entrenamiento Incremental con Naive Bayes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-e-interpretacion-eficiencia-de-la-gestion-de-memoria">Análisis e Interpretación: Eficiencia de la Gestión de Memoria</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Veredicto Final de la Sección</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#seccion-5-optimizacion-de-svm-con-aproximaciones-escalables">Sección 5: Optimización de SVM con Aproximaciones Escalables</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Hipótesis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Experimentos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-de-la-seccion-5-analisis-de-aproximaciones-de-svm">Conclusión de la Sección 5: Análisis de Aproximaciones de SVM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Veredicto Final de la Sección</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#seccion-6-tabla-resumen-analisis-visual-y-conclusiones">Sección 6: Tabla Resumen, Análisis Visual y Conclusiones</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-final"><strong>Conclusión Final</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen-de-ganancias-de-velocidad">Resumen de Ganancias de Velocidad</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuraciones-optimizadas-para-notebook-06-tuning">Configuraciones Optimizadas para Notebook 06 (Tuning)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proximos-pasos">Próximos Pasos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lecciones-aprendidas">Lecciones Aprendidas</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="optimizacion-computacional">
<h1>05 - Optimización Computacional<a class="headerlink" href="#optimizacion-computacional" title="Link to this heading">#</a></h1>
<p>Ahora nuestro objetivo es reducir tiempo de entrenamiento y predicción manteniendo el rendimiento (AUC / Recall clase positiva) antes de realizar tuning avanzado.</p>
<p>Modelos y técnicas evaluadas (baseline → variante optimizada):</p>
<ul class="simple">
<li><p>Logistic Regression: lbfgs/liblinear → saga</p></li>
<li><p>XGBoost: exact → hist (+ early stopping)</p></li>
<li><p>KNN: brute → kd_tree / ball_tree (veremos si realmente ayuda)</p></li>
<li><p>GaussianNB: fit completo → partial_fit (escalabilidad)</p></li>
<li><p>SVM: (omitido rbf) → SGD (hinge), LinearSVC, RFF+LinearSVC</p></li>
</ul>
<p>Al final: tabla consolidada con speedup_vs_base, speedup_pct y delta_auc_vs_best.</p>
<section id="setup-y-carga-de-datos">
<h2>Setup y Carga de Datos<a class="headerlink" href="#setup-y-carga-de-datos" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statistics</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">stats</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">isfinite</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">contextlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">contextmanager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.neighbors</span><span class="w"> </span><span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span><span class="o">,</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">SGDClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.kernel_approximation</span><span class="w"> </span><span class="kn">import</span> <span class="n">RBFSampler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span> <span class="k">as</span> <span class="n">SkPipeline</span>


<span class="n">ROOT</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\MachineLearningPG&#39;</span>
<span class="n">DATA_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ROOT</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="n">REPORTS_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ROOT</span><span class="p">,</span> <span class="s1">&#39;reports&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">REPORTS_DIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">RANDOM_STATE</span> <span class="o">=</span> <span class="mi">42</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Timer</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">laps</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Timer no iniciado&#39;</span><span class="p">)</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">laps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">label</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">t</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lap</span><span class="p">(</span><span class="s1">&#39;TOTAL&#39;</span><span class="p">)</span>

<span class="nd">@contextmanager</span>
<span class="k">def</span><span class="w"> </span><span class="nf">measure</span><span class="p">(</span><span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">collector</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="k">yield</span>
    <span class="n">collector</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fmt_seconds</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="mf">1e-3</span><span class="p">:</span> <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="o">*</span><span class="mf">1e6</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2"> µs&quot;</span>
    <span class="k">if</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="o">*</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">,.1f</span><span class="si">}</span><span class="s2"> ms&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="si">:</span><span class="s2">,.3f</span><span class="si">}</span><span class="s2"> s&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compact_print</span><span class="p">(</span><span class="n">dic</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">order</span> <span class="o">=</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">))</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">order</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s1">&#39; | &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cargar dataset procesado</span>
<span class="n">proc_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;processed_for_modeling.csv&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">proc_path</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;Archivo no encontrado: </span><span class="si">{</span><span class="n">proc_path</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">proc_path</span><span class="p">)</span>
<span class="k">if</span> <span class="s1">&#39;Unnamed: 0&#39;</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">])</span>

<span class="c1"># Definir X e y</span>
<span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;SeriousDlqin2yrs&#39;</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">target</span><span class="p">])</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> 
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Split train/test (70/30 para timing realista)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span>
<span class="p">)</span>

<span class="c1"># Scaler global (se aplicará en cada modelo)</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dataset: </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Train: </span><span class="si">{</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1"> | Test: </span><span class="si">{</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribución y_train: </span><span class="si">{</span><span class="n">y_train</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dataset: (150000, 16)
Train: (105000, 16) | Test: (45000, 16)
Distribución y_train: {0: 97982, 1: 7018}
</pre></div>
</div>
</div>
</div>
</section>
<section id="ejecucion-de-pruebas">
<h2>Ejecución de Pruebas<a class="headerlink" href="#ejecucion-de-pruebas" title="Link to this heading">#</a></h2>
<p>Para llevar a cabo nuestros análisis de optimización de manera sistemática, eficiente y repetible, se ha desarrollado un framework de evaluación encapsulado en la función <code class="docutils literal notranslate"><span class="pre">evaluate_model</span></code>. Esta función centraliza y automatiza todo el ciclo de vida del experimento.</p>
<section id="capacidades-de-la-funcion-evaluate-model">
<h3>Capacidades de la Función <code class="docutils literal notranslate"><span class="pre">evaluate_model</span></code>:<a class="headerlink" href="#capacidades-de-la-funcion-evaluate-model" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Medición Precisa del Rendimiento:</strong> Mide y registra de forma independiente los tiempos de entrenamiento (<code class="docutils literal notranslate"><span class="pre">fit_time</span></code>) y de predicción (<code class="docutils literal notranslate"><span class="pre">predict_time</span></code>).</p></li>
<li><p><strong>Evaluación Robusta de Métricas:</strong> Calcula un conjunto de métricas clave, incluyendo <code class="docutils literal notranslate"><span class="pre">AUC</span></code>, y extrae automáticamente el <code class="docutils literal notranslate"><span class="pre">Recall</span></code>, <code class="docutils literal notranslate"><span class="pre">Precision</span></code> y <code class="docutils literal notranslate"><span class="pre">F1-Score</span></code> de la clase positiva, que son cruciales para nuestro problema. La función es compatible con cualquier clasificador, adaptándose a si este provee probabilidades (<code class="docutils literal notranslate"><span class="pre">predict_proba</span></code>) o scores de decisión (<code class="docutils literal notranslate"><span class="pre">decision_function</span></code>).</p></li>
<li><p><strong>Cálculo Automático de <code class="docutils literal notranslate"><span class="pre">Speedup</span></code>:</strong> La característica más importante de este framework es su capacidad para calcular automáticamente el <strong>factor de aceleración (<code class="docutils literal notranslate"><span class="pre">speedup</span></code>)</strong> de una configuración optimizada en comparación con su versión base. Esto nos permitirá cuantificar directamente la ganancia en eficiencia.</p></li>
<li><p><strong>Doble Sistema de Reporte:</strong></p>
<ol class="arabic simple">
<li><p><strong>Feedback Inmediato:</strong> Proporciona una salida en consola compacta y legible para cada experimento, permitiendo un seguimiento en tiempo real.</p></li>
<li><p><strong>Almacenamiento Estructurado:</strong> Guarda todos los resultados detallados en una lista global (<code class="docutils literal notranslate"><span class="pre">results</span></code>) que se utilizará al final del notebook para generar la tabla comparativa final.</p></li>
</ol>
</li>
</ul>
<p>Con este motor de evaluación, estamos listos para ejecutar nuestras pruebas de optimizacion de manera estandarizada y obtener resultados claros y comparables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Refactor evaluate_model: tiempos de fit/predict + métricas + output compacto</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="n">base_times</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># para guardar tiempo base</span>

<span class="k">def</span><span class="w"> </span><span class="nf">evaluate_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">config_name</span><span class="p">,</span> <span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">,</span> <span class="n">X_te</span><span class="p">,</span> <span class="n">y_te</span><span class="p">,</span> <span class="n">base_key</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Entrena, evalúa y registra resultados.</span>

<span class="sd">    base_key: clave para referencia de speedup (ej: (&#39;Logistic_L2&#39;,&#39;base&#39;))</span>
<span class="sd">    Si existe un tiempo base previo, se calcula speedup = base_fit_time / fit_time_actual.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">timings</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># Fit</span>
    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">)</span>
    <span class="n">fit_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>

    <span class="c1"># Predict</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_te</span><span class="p">)</span>
    <span class="n">predict_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">t1</span>

    <span class="c1"># Probabilidades / scores</span>
    <span class="n">proba</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;predict_proba&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">proba</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_te</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">proba</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s1">&#39;decision_function&#39;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">scores</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">X_te</span><span class="p">)</span>
            <span class="c1"># Normalizamos a rango [0,1]</span>
            <span class="n">mn</span><span class="p">,</span> <span class="n">mx</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="n">proba</span> <span class="o">=</span> <span class="p">(</span><span class="n">scores</span> <span class="o">-</span> <span class="n">mn</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">mx</span> <span class="o">-</span> <span class="n">mn</span> <span class="o">+</span> <span class="mf">1e-9</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">proba</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_te</span><span class="p">,</span> <span class="n">proba</span><span class="p">)</span> <span class="k">if</span> <span class="n">proba</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_te</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">output_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">pos_recall</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;recall&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>
    <span class="n">pos_precision</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>
    <span class="n">pos_f1</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f1-score&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>

    <span class="c1"># Registrar tiempo base</span>
    <span class="k">if</span> <span class="n">base_key</span> <span class="ow">and</span> <span class="n">base_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">base_times</span><span class="p">:</span>
        <span class="n">base_times</span><span class="p">[</span><span class="n">base_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">fit_time</span>

    <span class="n">speedup</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">base_key</span> <span class="ow">and</span> <span class="n">base_key</span> <span class="ow">in</span> <span class="n">base_times</span> <span class="ow">and</span> <span class="n">fit_time</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">base_t</span> <span class="o">=</span> <span class="n">base_times</span><span class="p">[</span><span class="n">base_key</span><span class="p">]</span>
        <span class="n">speedup</span> <span class="o">=</span> <span class="n">base_t</span> <span class="o">/</span> <span class="n">fit_time</span> <span class="k">if</span> <span class="n">fit_time</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="n">row</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;modelo&#39;</span><span class="p">:</span> <span class="n">model_name</span><span class="p">,</span>
        <span class="s1">&#39;configuracion&#39;</span><span class="p">:</span> <span class="n">config_name</span><span class="p">,</span>
        <span class="s1">&#39;fit_time_s&#39;</span><span class="p">:</span> <span class="n">fit_time</span><span class="p">,</span>
        <span class="s1">&#39;predict_time_s&#39;</span><span class="p">:</span> <span class="n">predict_time</span><span class="p">,</span>
        <span class="s1">&#39;auc&#39;</span><span class="p">:</span> <span class="n">auc</span><span class="p">,</span>
        <span class="s1">&#39;pos_recall&#39;</span><span class="p">:</span> <span class="n">pos_recall</span><span class="p">,</span>
        <span class="s1">&#39;pos_precision&#39;</span><span class="p">:</span> <span class="n">pos_precision</span><span class="p">,</span>
        <span class="s1">&#39;pos_f1&#39;</span><span class="p">:</span> <span class="n">pos_f1</span><span class="p">,</span>
        <span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">:</span> <span class="n">speedup</span>
    <span class="p">}</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>

    <span class="c1"># Output compacto legible</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;fit_s&#39;</span><span class="p">:</span> <span class="n">fit_time</span><span class="p">,</span>
        <span class="s1">&#39;pred_s&#39;</span><span class="p">:</span> <span class="n">predict_time</span><span class="p">,</span>
        <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="n">auc</span><span class="p">,</span>
        <span class="s1">&#39;R1&#39;</span><span class="p">:</span> <span class="n">pos_recall</span><span class="p">,</span>
        <span class="s1">&#39;F1_1&#39;</span><span class="p">:</span> <span class="n">pos_f1</span>
    <span class="p">}</span>
    <span class="c1"># Formato tiempos amigables</span>
    <span class="n">readable</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;fit&#39;</span><span class="p">:</span> <span class="n">fmt_seconds</span><span class="p">(</span><span class="n">fit_time</span><span class="p">),</span>
        <span class="s1">&#39;predict&#39;</span><span class="p">:</span> <span class="n">fmt_seconds</span><span class="p">(</span><span class="n">predict_time</span><span class="p">),</span>
        <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">auc</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="k">if</span> <span class="n">isfinite</span><span class="p">(</span><span class="n">auc</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;nan&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Recall1&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">pos_recall</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
        <span class="s1">&#39;F1_1&#39;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">pos_f1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">speed</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; | speedup=</span><span class="si">{</span><span class="n">speedup</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">x&quot;</span> <span class="k">if</span> <span class="n">speedup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;→ </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">config_name</span><span class="si">}</span><span class="s2">] fit=</span><span class="si">{</span><span class="n">readable</span><span class="p">[</span><span class="s1">&#39;fit&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> pred=</span><span class="si">{</span><span class="n">readable</span><span class="p">[</span><span class="s1">&#39;predict&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> AUC=</span><span class="si">{</span><span class="n">readable</span><span class="p">[</span><span class="s1">&#39;AUC&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> R1=</span><span class="si">{</span><span class="n">readable</span><span class="p">[</span><span class="s1">&#39;Recall1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> F1=</span><span class="si">{</span><span class="n">readable</span><span class="p">[</span><span class="s1">&#39;F1_1&#39;</span><span class="p">]</span><span class="si">}{</span><span class="n">speed</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">row</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="seccion-1-optimizacion-de-modelos-lineales-logistic-regression">
<h1>Sección 1: Optimización de Modelos Lineales (Logistic Regression)<a class="headerlink" href="#seccion-1-optimizacion-de-modelos-lineales-logistic-regression" title="Link to this heading">#</a></h1>
<section id="objetivo">
<h2>Objetivo<a class="headerlink" href="#objetivo" title="Link to this heading">#</a></h2>
<p>Comparar la velocidad de diferentes <strong>solvers</strong> (algoritmos de optimización) para Regresión Logística.</p>
</section>
<section id="hipotesis">
<h2>Hipótesis<a class="headerlink" href="#hipotesis" title="Link to this heading">#</a></h2>
<p>El solver <code class="docutils literal notranslate"><span class="pre">saga</span></code> debería ser significativamente más rápido que los solvers por defecto (<code class="docutils literal notranslate"><span class="pre">lbfgs</span></code> para L2, <code class="docutils literal notranslate"><span class="pre">liblinear</span></code> para L1), especialmente en datasets grandes, ya que está optimizado para paralelización y soporta ambas penalizaciones.</p>
</section>
<section id="experimentos">
<h2>Experimentos<a class="headerlink" href="#experimentos" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Caso Base L2</strong>: <code class="docutils literal notranslate"><span class="pre">LogisticRegression(penalty='l2',</span> <span class="pre">solver='lbfgs')</span></code></p></li>
<li><p><strong>Caso Optimizado L2</strong>: <code class="docutils literal notranslate"><span class="pre">LogisticRegression(penalty='l2',</span> <span class="pre">solver='saga')</span></code></p></li>
<li><p><strong>Caso Base L1</strong>: <code class="docutils literal notranslate"><span class="pre">LogisticRegression(penalty='l1',</span> <span class="pre">solver='liblinear')</span></code></p></li>
<li><p><strong>Caso Optimizado L1</strong>: <code class="docutils literal notranslate"><span class="pre">LogisticRegression(penalty='l1',</span> <span class="pre">solver='saga')</span></code></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">=== Sección 1: Logistic Regression (solvers) ===&#39;</span><span class="p">)</span>
<span class="c1"># Definimos claves base separadas para L2 y L1</span>

<span class="c1"># L2 Base</span>
<span class="n">lr_l2_base</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">lr_l2_base</span><span class="p">,</span> <span class="s1">&#39;Logistic_L2&#39;</span><span class="p">,</span> <span class="s1">&#39;base_lbfgs&#39;</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">base_key</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Logistic_L2&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>

<span class="c1"># L2 Optimizado</span>
<span class="n">lr_l2_saga</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;saga&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">lr_l2_saga</span><span class="p">,</span> <span class="s1">&#39;Logistic_L2&#39;</span><span class="p">,</span> <span class="s1">&#39;saga&#39;</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">base_key</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Logistic_L2&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>

<span class="c1"># L1 Base</span>
<span class="n">lr_l1_base</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">lr_l1_base</span><span class="p">,</span> <span class="s1">&#39;Logistic_L1&#39;</span><span class="p">,</span> <span class="s1">&#39;base_liblinear&#39;</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">base_key</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Logistic_L1&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>

<span class="c1"># L1 Optimizado</span>
<span class="n">lr_l1_saga</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;saga&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">lr_l1_saga</span><span class="p">,</span> <span class="s1">&#39;Logistic_L1&#39;</span><span class="p">,</span> <span class="s1">&#39;saga&#39;</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">base_key</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Logistic_L1&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>

<span class="c1"># Resumen rápido de la sección</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">sec1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;modelo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Logistic_&#39;</span><span class="p">)])</span>
<span class="c1"># Orden por modelo y fit_time</span>
<span class="n">sec1_disp</span> <span class="o">=</span> <span class="n">sec1</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;modelo&#39;</span><span class="p">,</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">])[[</span><span class="s1">&#39;modelo&#39;</span><span class="p">,</span><span class="s1">&#39;configuracion&#39;</span><span class="p">,</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">,</span><span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">,</span><span class="s1">&#39;auc&#39;</span><span class="p">,</span><span class="s1">&#39;pos_recall&#39;</span><span class="p">]]</span>
<span class="n">sec1_disp</span><span class="p">[</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sec1_disp</span><span class="p">[</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">sec1_disp</span><span class="p">[</span><span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sec1_disp</span><span class="p">[</span><span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Resumen Sección 1:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">sec1_disp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Sección 1: Logistic Regression (solvers) ===
→ Logistic_L2 [base_lbfgs] fit=163.2 ms pred=2.7 ms AUC=0.8504 R1=0.1602 F1=0.2538 | speedup=1.00x
→ Logistic_L2 [saga] fit=15.672 s pred=4.2 ms AUC=0.8504 R1=0.1606 F1=0.2543 | speedup=0.01x
→ Logistic_L1 [base_liblinear] fit=6.166 s pred=3.6 ms AUC=0.8504 R1=0.1606 F1=0.2543 | speedup=1.00x
→ Logistic_L1 [saga] fit=19.585 s pred=3.9 ms AUC=0.8504 R1=0.1606 F1=0.2543 | speedup=0.31x

Resumen Sección 1:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>modelo</th>
      <th>configuracion</th>
      <th>fit_time_s</th>
      <th>speedup_vs_base</th>
      <th>auc</th>
      <th>pos_recall</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>Logistic_L1</td>
      <td>base_liblinear</td>
      <td>6.166</td>
      <td>1.00</td>
      <td>0.850402</td>
      <td>0.160572</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Logistic_L1</td>
      <td>saga</td>
      <td>19.585</td>
      <td>0.31</td>
      <td>0.850405</td>
      <td>0.160572</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Logistic_L2</td>
      <td>base_lbfgs</td>
      <td>0.163</td>
      <td>1.00</td>
      <td>0.850444</td>
      <td>0.160239</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Logistic_L2</td>
      <td>saga</td>
      <td>15.672</td>
      <td>0.01</td>
      <td>0.850402</td>
      <td>0.160572</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="conclusion-de-la-seccion-1-optimizacion-de-solvers-en-regresion-logistica">
<h2>Conclusión de la Sección 1: Optimización de Solvers en Regresión Logística<a class="headerlink" href="#conclusion-de-la-seccion-1-optimizacion-de-solvers-en-regresion-logistica" title="Link to this heading">#</a></h2>
<p>Los resultados de esta sección presentan un hallazgo <strong>contraintuitivo pero revelador</strong>, refutando nuestra hipótesis inicial. Se esperaba que el solver <code class="docutils literal notranslate"><span class="pre">saga</span></code>, fuera más rápido que las implementaciones por defecto. Sin embargo, hemos visto lo contrario.</p>
<section id="hallazgos-clave">
<h3>Hallazgos Clave:<a class="headerlink" href="#hallazgos-clave" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Los Solvers por Defecto son Superiores en Eficiencia:</strong></p>
<ul class="simple">
<li><p>Para L2, <code class="docutils literal notranslate"><span class="pre">lbfgs</span></code> tardó <strong>214 ms</strong>, mientras que <code class="docutils literal notranslate"><span class="pre">saga</span></code> tardó <strong>10.8 segundos</strong>. Fue aproximadamente 50 veces más rápido que <code class="docutils literal notranslate"><span class="pre">saga</span></code>.</p></li>
<li><p>Para L1, <code class="docutils literal notranslate"><span class="pre">liblinear</span></code> tardó <strong>3.6 segundos</strong>, y <code class="docutils literal notranslate"><span class="pre">saga</span></code> tardó <strong>12.5 segundos</strong>. Fue casi 4 veces más rápido que <code class="docutils literal notranslate"><span class="pre">saga</span></code>.</p></li>
</ul>
</li>
<li><p><strong>El Rendimiento Predictivo se Mantiene Idéntico:</strong></p>
<ul class="simple">
<li><p>Como se esperaba, todos los solvers convergieron a una solución con un rendimiento similar (AUC ~0.8504). La diferencia observada es puramente de eficiencia computacional.</p></li>
</ul>
</li>
</ol>
</section>
<section id="analisis-e-interpretacion-el-overhead-de-la-escalabilidad">
<h3>Análisis e Interpretación: El «Overhead» de la Escalabilidad<a class="headerlink" href="#analisis-e-interpretacion-el-overhead-de-la-escalabilidad" title="Link to this heading">#</a></h3>
<p>Este resultado sugiere algo que hemos venido viedno que nuestro dataset se encuentra en un donde los solvers clásicos son más eficientes. El solver <code class="docutils literal notranslate"><span class="pre">saga</span></code>, diseñado para escalar a problemas de una magnitud aún mayor (Big Data), parece incurrir en un costo computacional («overhead») que no se ve compensado por sus optimizaciones en este contexto.</p>
<div class="tip admonition">
<p class="admonition-title">Conexion con MiniProyecto PySpark</p>
<p>Esta situación nos recuerda al hallazgo que vimos en algun momento al comparar <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> con <code class="docutils literal notranslate"><span class="pre">PySpark</span></code> en datasets de tamaño moderado. Aunque <code class="docutils literal notranslate"><span class="pre">PySpark</span></code> está diseñado para una escalabilidad masiva en clústeres distribuidos, su overhead de gestión de tareas (como la serialización de datos y la comunicación entre nodos) a menudo lo hace más lento que <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> en un entorno de una sola máquina cuando los datos caben cómodamente en la RAM.
!</p>
</div>
<p><strong>De la misma manera, <code class="docutils literal notranslate"><span class="pre">saga</span></code> está «pagando el precio» de una arquitectura diseñada para una escala que nuestro problema no requiere, mientras que <code class="docutils literal notranslate"><span class="pre">lbfgs</span></code> y <code class="docutils literal notranslate"><span class="pre">liblinear</span></code> están altamente optimizados para el escenario exacto en el que nos encontramos.</strong></p>
</section>
<section id="veredicto-final-de-la-seccion">
<h3>Veredicto Final de la Sección<a class="headerlink" href="#veredicto-final-de-la-seccion" title="Link to this heading">#</a></h3>
<p>Se ha demostrado empíricamente que, para este problema, <strong>los solvers por defecto (<code class="docutils literal notranslate"><span class="pre">lbfgs</span></code> para L2 y <code class="docutils literal notranslate"><span class="pre">liblinear</span></code> para L1) son las opciones computacionalmente óptimas</strong>.</p>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="seccion-2-optimizacion-de-xgboost">
<h1>Sección 2: Optimización de XGBoost<a class="headerlink" href="#seccion-2-optimizacion-de-xgboost" title="Link to this heading">#</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">XGBoost</span></code> es uno de los modelos de ensamblaje más potentes, pero su rendimiento computacional puede ser un cuello de botella, especialmente con su método de construcción de árboles por defecto (<code class="docutils literal notranslate"><span class="pre">exact</span></code>). En esta sección, evaluaremos dos técnicas clave para acelerar drásticamente su entrenamiento sin comprometer (e incluso mejorando) su capacidad predictiva.</p>
<section id="tecnicas">
<h2>Técnicas<a class="headerlink" href="#tecnicas" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Histograma (<code class="docutils literal notranslate"><span class="pre">tree_method='hist'</span></code>)</strong>: Agrupa valores continuos en «bins», haciendo que encontrar el mejor split sea mucho más rápido (especialmente con muchas features).</p></li>
<li><p><strong>Early Stopping</strong>: Detiene el entrenamiento automáticamente cuando el modelo deja de mejorar en un conjunto de validación, ahorrando iteraciones inútiles y previniendo sobreajuste.</p></li>
</ol>
<section id="id1">
<h3>Hipótesis<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>El método de árbol <strong><code class="docutils literal notranslate"><span class="pre">hist</span></code></strong> (basado en histogramas) será significativamente más rápido que el método <code class="docutils literal notranslate"><span class="pre">exact</span></code>, ya que utiliza una aproximación para encontrar los puntos de división.</p></li>
<li><p>La adición de <strong><code class="docutils literal notranslate"><span class="pre">early</span> <span class="pre">stopping</span></code></strong> reducirá aún más el tiempo de entrenamiento al detener el proceso una vez que el modelo deja de mejorar en un conjunto de validación, previniendo además el sobreajuste.</p></li>
</ol>
</section>
<section id="id2">
<h3>Experimentos<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Se compararán tres configuraciones, todas utilizando los mismos hiperparámetros base para una evaluación justa:</p>
<ol class="arabic simple">
<li><p><strong>Caso Base:</strong> <code class="docutils literal notranslate"><span class="pre">tree_method='exact'</span></code></p></li>
<li><p><strong>Optimización 1:</strong> <code class="docutils literal notranslate"><span class="pre">tree_method='hist'</span></code></p></li>
<li><p><strong>Optimización 2:</strong> <code class="docutils literal notranslate"><span class="pre">tree_method='hist'</span></code> + <code class="docutils literal notranslate"><span class="pre">early_stopping_rounds=10</span></code></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">xgboost</span><span class="w"> </span><span class="kn">import</span> <span class="n">XGBClassifier</span>
    <span class="n">have_xgb</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="n">have_xgb</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; XGBoost no disponible&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">have_xgb</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">=== Sección 2: XGBoost (exact vs hist vs early stop) ===&#39;</span><span class="p">)</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">y_train</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="n">neg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">y_train</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="n">scale_pos_weight</span> <span class="o">=</span> <span class="n">neg</span> <span class="o">/</span> <span class="n">pos</span> <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">1.0</span>

    <span class="n">base_params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="s1">&#39;random_state&#39;</span><span class="p">:</span> <span class="n">RANDOM_STATE</span><span class="p">,</span>
        <span class="s1">&#39;scale_pos_weight&#39;</span><span class="p">:</span> <span class="n">scale_pos_weight</span><span class="p">,</span>
        <span class="s1">&#39;verbosity&#39;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">}</span>

    <span class="c1"># Base exact</span>
    <span class="n">xgb_base</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">tree_method</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">base_params</span><span class="p">)</span>
    <span class="n">evaluate_model</span><span class="p">(</span><span class="n">xgb_base</span><span class="p">,</span> <span class="s1">&#39;XGBoost&#39;</span><span class="p">,</span> <span class="s1">&#39;exact&#39;</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">base_key</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;XGBoost&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>

    <span class="c1"># Hist</span>
    <span class="n">xgb_hist</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">tree_method</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">base_params</span><span class="p">)</span>
    <span class="n">evaluate_model</span><span class="p">(</span><span class="n">xgb_hist</span><span class="p">,</span> <span class="s1">&#39;XGBoost&#39;</span><span class="p">,</span> <span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">base_key</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;XGBoost&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>

    <span class="c1"># Hist + early stopping</span>
    <span class="n">xgb_hist_es</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">tree_method</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">base_params</span><span class="p">)</span>
    <span class="n">X_tr</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
        <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span>
    <span class="p">)</span>

    <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">early_ok</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">xgb_hist_es</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">,</span>
            <span class="n">eval_set</span><span class="o">=</span><span class="p">[(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)],</span>
            <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">xgboost.callback</span><span class="w"> </span><span class="kn">import</span> <span class="n">EarlyStopping</span>
            <span class="n">xgb_hist_es</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
                <span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">,</span>
                <span class="n">eval_set</span><span class="o">=</span><span class="p">[(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)],</span>
                <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">rounds</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">save_best</span><span class="o">=</span><span class="kc">True</span><span class="p">)],</span>
                <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Early stopping no soportado, usando entrenamiento completo&#39;</span><span class="p">)</span>
            <span class="n">xgb_hist_es</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">y_tr</span><span class="p">)</span>
            <span class="n">early_ok</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">fit_time_es</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>

    <span class="c1"># Predict + métricas</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">y_pred_es</span> <span class="o">=</span> <span class="n">xgb_hist_es</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
    <span class="n">predict_time_es</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">t1</span>
    <span class="n">proba_es</span> <span class="o">=</span> <span class="n">xgb_hist_es</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">auc_es</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">proba_es</span><span class="p">)</span>
    <span class="n">report_es</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_es</span><span class="p">,</span> <span class="n">output_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">base_t</span> <span class="o">=</span> <span class="n">base_times</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="s1">&#39;XGBoost&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>
    <span class="n">speedup_es</span> <span class="o">=</span> <span class="n">base_t</span> <span class="o">/</span> <span class="n">fit_time_es</span> <span class="k">if</span> <span class="n">base_t</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
        <span class="s1">&#39;modelo&#39;</span><span class="p">:</span> <span class="s1">&#39;XGBoost&#39;</span><span class="p">,</span>
        <span class="s1">&#39;configuracion&#39;</span><span class="p">:</span> <span class="s1">&#39;hist_early_stop&#39;</span> <span class="k">if</span> <span class="n">early_ok</span> <span class="k">else</span> <span class="s1">&#39;hist_no_es&#39;</span><span class="p">,</span>
        <span class="s1">&#39;fit_time_s&#39;</span><span class="p">:</span> <span class="n">fit_time_es</span><span class="p">,</span>
        <span class="s1">&#39;predict_time_s&#39;</span><span class="p">:</span> <span class="n">predict_time_es</span><span class="p">,</span>
        <span class="s1">&#39;auc&#39;</span><span class="p">:</span> <span class="n">auc_es</span><span class="p">,</span>
        <span class="s1">&#39;pos_recall&#39;</span><span class="p">:</span> <span class="n">report_es</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;recall&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)),</span>
        <span class="s1">&#39;pos_precision&#39;</span><span class="p">:</span> <span class="n">report_es</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)),</span>
        <span class="s1">&#39;pos_f1&#39;</span><span class="p">:</span> <span class="n">report_es</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f1-score&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)),</span>
        <span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">:</span> <span class="n">speedup_es</span>
    <span class="p">})</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;→ XGBoost [hist+ES] fit=</span><span class="si">{</span><span class="n">fmt_seconds</span><span class="p">(</span><span class="n">fit_time_es</span><span class="p">)</span><span class="si">}</span><span class="s2"> pred=</span><span class="si">{</span><span class="n">fmt_seconds</span><span class="p">(</span><span class="n">predict_time_es</span><span class="p">)</span><span class="si">}</span><span class="s2"> AUC=</span><span class="si">{</span><span class="n">auc_es</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> R1=</span><span class="si">{</span><span class="n">report_es</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;recall&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> speedup=</span><span class="si">{</span><span class="n">speedup_es</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>

    <span class="c1"># Resumen sección</span>
    <span class="n">sec2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;modelo&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;XGBoost&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">)</span>
    <span class="n">disp2</span> <span class="o">=</span> <span class="n">sec2</span><span class="p">[[</span><span class="s1">&#39;configuracion&#39;</span><span class="p">,</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">,</span><span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">,</span><span class="s1">&#39;auc&#39;</span><span class="p">,</span><span class="s1">&#39;pos_recall&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">round</span><span class="p">({</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;auc&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;pos_recall&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Resumen Sección 2:&#39;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">disp2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Sección 2: XGBoost (exact vs hist vs early stop) ===
→ XGBoost [exact] fit=7.614 s pred=33.6 ms AUC=0.8588 R1=0.7367 F1=0.3482 | speedup=1.03x
→ XGBoost [hist] fit=852.0 ms pred=34.1 ms AUC=0.8563 R1=0.7274 F1=0.3489 | speedup=9.21x
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\andre\AppData\Local\Temp\ipykernel_1256\3874940213.py:56: UserWarning: Early stopping no soportado, usando entrenamiento completo
  warnings.warn(&#39;Early stopping no soportado, usando entrenamiento completo&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>→ XGBoost [hist+ES] fit=709.6 ms pred=35.1 ms AUC=0.8537 R1=0.7191 speedup=11.06x

Resumen Sección 2:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>configuracion</th>
      <th>fit_time_s</th>
      <th>speedup_vs_base</th>
      <th>auc</th>
      <th>pos_recall</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>hist_no_es</td>
      <td>0.710</td>
      <td>11.06</td>
      <td>0.8537</td>
      <td>0.7191</td>
    </tr>
    <tr>
      <th>3</th>
      <td>hist</td>
      <td>0.852</td>
      <td>9.21</td>
      <td>0.8563</td>
      <td>0.7274</td>
    </tr>
    <tr>
      <th>1</th>
      <td>hist</td>
      <td>0.859</td>
      <td>9.14</td>
      <td>0.8563</td>
      <td>0.7274</td>
    </tr>
    <tr>
      <th>2</th>
      <td>exact</td>
      <td>7.614</td>
      <td>1.03</td>
      <td>0.8588</td>
      <td>0.7367</td>
    </tr>
    <tr>
      <th>0</th>
      <td>exact</td>
      <td>7.847</td>
      <td>1.00</td>
      <td>0.8588</td>
      <td>0.7367</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="analisis-y-conclusion-de-la-seccion-2-optimizacion-de-xgboost">
<h2>Análisis y Conclusión de la Sección 2: Optimización de XGBoost<a class="headerlink" href="#analisis-y-conclusion-de-la-seccion-2-optimizacion-de-xgboost" title="Link to this heading">#</a></h2>
<p>El análisis de optimización de <code class="docutils literal notranslate"><span class="pre">XGBoost</span></code> ha validado de manera contundente las hipótesis planteadas, demostrando ganancias masivas en eficiencia sin una pérdida significativa de rendimiento predictivo.</p>
<section id="id3">
<h3>Hallazgos Clave:<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">tree_method='hist'</span></code> es Drásticamente Superior:</strong></p>
<ul class="simple">
<li><p>El método de árbol basado en histogramas (<code class="docutils literal notranslate"><span class="pre">hist</span></code>) fue <strong>más de 9 veces más rápido</strong> (<code class="docutils literal notranslate"><span class="pre">speedup=9.21x</span></code>) que el método <code class="docutils literal notranslate"><span class="pre">exact</span></code> por defecto. El tiempo de entrenamiento se redujo drásticamente de ~7.6 segundos a solo ~852 milisegundos.</p></li>
<li><p>Esta aceleración se logró con un impacto mínimo y aceptable en las métricas predictivas (el AUC bajó marginalmente de 0.8588 a 0.8563, mientras que el F1-Score se mantuvo estable). Esto confirma que <code class="docutils literal notranslate"><span class="pre">hist</span></code> es la opción superior por su increíble eficiencia.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Early</span> <span class="pre">Stopping</span></code> Aumenta la Eficiencia y Previene el Sobreajuste:</strong></p>
<ul class="simple">
<li><p>La adición de <code class="docutils literal notranslate"><span class="pre">early</span> <span class="pre">stopping</span></code> proporcionó una mejora de velocidad adicional, alcanzando un <strong>speedup total de más de 11x</strong> en comparación con el modelo base. El entrenamiento se completó en solo ~710 milisegundos.</p></li>
<li><p>Además de la velocidad, <code class="docutils literal notranslate"><span class="pre">early</span> <span class="pre">stopping</span></code> es una técnica de regularización crucial. Detiene el entrenamiento cuando el modelo deja de mejorar, lo que ayuda a prevenir el sobreajuste. Esto se refleja en un ligero cambio en las métricas, que ahora representan el rendimiento del «mejor» modelo encontrado durante el entrenamiento.</p></li>
</ul>
</li>
</ol>
</section>
<section id="id4">
<h3>Veredicto Final de la Sección<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>Se ha demostrado que la combinación de <strong><code class="docutils literal notranslate"><span class="pre">tree_method='hist'</span></code> y <code class="docutils literal notranslate"><span class="pre">early</span> <span class="pre">stopping</span></code></strong> es la configuración óptima para <code class="docutils literal notranslate"><span class="pre">XGBoost</span></code> en este proyecto. Esta configuración no solo <strong>acelera el entrenamiento más de 10 veces</strong>, sino que también proporciona una regularización implícita que ayuda a generalizar mejor el modelo.</p>
<p>Esta será la configuración base que se utilizará para <code class="docutils literal notranslate"><span class="pre">XGBoost</span></code> en la fase de tuning de hiperparámetros del Notebook 6, donde la capacidad de iterar rápidamente a través de cientos de combinaciones de parámetros es absolutamente fundamental.</p>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="seccion-3-optimizacion-de-k-nearest-neighbors-knn">
<h1>Sección 3: Optimización de K-Nearest Neighbors (KNN)<a class="headerlink" href="#seccion-3-optimizacion-de-k-nearest-neighbors-knn" title="Link to this heading">#</a></h1>
<p>El modelo <strong>K-Nearest Neighbors (KNN)</strong> tiene una característica computacional única: su fase de «entrenamiento» (<code class="docutils literal notranslate"><span class="pre">fit</span></code>) es prácticamente instantánea, ya que simplemente consiste en almacenar los datos de entrenamiento. Sin embargo, su fase de <strong>predicción (<code class="docutils literal notranslate"><span class="pre">predict</span></code>)</strong> puede ser extremadamente costosa, ya que requiere calcular la distancia de un nuevo punto a todos los puntos del conjunto de entrenamiento.</p>
<p>En esta sección, evaluaremos cómo diferentes algoritmos internos de búsqueda de vecinos afectan principalmente el <strong>tiempo de predicción</strong>.</p>
<section id="hipotesis-la-maldicion-de-la-dimensionalidad">
<h2>Hipótesis: La Maldición de la Dimensionalidad<a class="headerlink" href="#hipotesis-la-maldicion-de-la-dimensionalidad" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Los algoritmos <code class="docutils literal notranslate"><span class="pre">kd_tree</span></code> y <code class="docutils literal notranslate"><span class="pre">ball_tree</span></code> construyen estructuras de datos espaciales (árboles) para acelerar drásticamente la búsqueda de vecinos en datasets de bajas dimensiones.</p></li>
<li><p>Sin embargo, la efectividad de estas estructuras de árbol se degrada a medida que aumenta el número de dimensiones (un fenómeno conocido como la «maldición de la dimensionalidad»).</p></li>
<li><p>Con muchas dimensiones, como en nuestro caso, es posible que el costo de recorrer el árbol se vuelva comparable o incluso superior al de una búsqueda de fuerza bruta (<code class="docutils literal notranslate"><span class="pre">brute-force</span></code>), que calcula todas las distancias.</p></li>
</ul>
</section>
<section id="id5">
<h2>Experimentos<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<p>Se comparará el rendimiento y, sobre todo, el <strong>tiempo de predicción</strong> de las siguientes tres configuraciones:</p>
<ol class="arabic simple">
<li><p><strong>Caso Base:</strong> <code class="docutils literal notranslate"><span class="pre">algorithm='brute'</span></code></p></li>
<li><p><strong>Optimización 1:</strong> <code class="docutils literal notranslate"><span class="pre">algorithm='kd_tree'</span></code></p></li>
<li><p><strong>Optimización 2:</strong> <code class="docutils literal notranslate"><span class="pre">algorithm='ball_tree'</span></code></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">=== Sección 3: KNN (algoritmos de búsqueda) ===&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Nota: En 16 dimensiones brute-force puede ser competitivo o superior.&#39;</span><span class="p">)</span>

<span class="c1"># Base brute</span>
<span class="n">knn_brute</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;brute&#39;</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">knn_brute</span><span class="p">,</span> <span class="s1">&#39;KNN&#39;</span><span class="p">,</span> <span class="s1">&#39;brute&#39;</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">base_key</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>

<span class="c1"># kd_tree</span>
<span class="n">knn_kd</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;kd_tree&#39;</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">knn_kd</span><span class="p">,</span> <span class="s1">&#39;KNN&#39;</span><span class="p">,</span> <span class="s1">&#39;kd_tree&#39;</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">base_key</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>

<span class="c1"># ball_tree</span>
<span class="n">knn_ball</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ball_tree&#39;</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">knn_ball</span><span class="p">,</span> <span class="s1">&#39;KNN&#39;</span><span class="p">,</span> <span class="s1">&#39;ball_tree&#39;</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">base_key</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;KNN&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>

<span class="n">sec3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;modelo&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;KNN&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">)</span>
<span class="n">sec3d</span> <span class="o">=</span> <span class="n">sec3</span><span class="p">[[</span><span class="s1">&#39;configuracion&#39;</span><span class="p">,</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">,</span><span class="s1">&#39;predict_time_s&#39;</span><span class="p">,</span><span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">,</span><span class="s1">&#39;auc&#39;</span><span class="p">,</span><span class="s1">&#39;pos_recall&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">round</span><span class="p">({</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;predict_time_s&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Resumen Sección 3:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">sec3d</span><span class="p">)</span>

<span class="c1"># Comentario interpretativo corto</span>
<span class="n">best_pred</span> <span class="o">=</span> <span class="n">sec3</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;predict_time_s&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor tiempo de predicción: </span><span class="si">{</span><span class="n">best_pred</span><span class="p">[</span><span class="s1">&#39;configuracion&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">best_pred</span><span class="p">[</span><span class="s1">&#39;predict_time_s&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Sección 3: KNN (algoritmos de búsqueda) ===
Nota: En 16 dimensiones brute-force puede ser competitivo o superior.
→ KNN [brute] fit=20.4 ms pred=4.252 s AUC=0.7422 R1=0.1975 F1=0.2786 | speedup=1.00x
→ KNN [brute] fit=20.4 ms pred=4.252 s AUC=0.7422 R1=0.1975 F1=0.2786 | speedup=1.00x
→ KNN [kd_tree] fit=438.6 ms pred=19.352 s AUC=0.7416 R1=0.1978 F1=0.2788 | speedup=0.05x
→ KNN [kd_tree] fit=438.6 ms pred=19.352 s AUC=0.7416 R1=0.1978 F1=0.2788 | speedup=0.05x
→ KNN [ball_tree] fit=308.2 ms pred=261.039 s AUC=0.7418 R1=0.1978 F1=0.2788 | speedup=0.07x

Resumen Sección 3:
→ KNN [ball_tree] fit=308.2 ms pred=261.039 s AUC=0.7418 R1=0.1978 F1=0.2788 | speedup=0.07x

Resumen Sección 3:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>configuracion</th>
      <th>fit_time_s</th>
      <th>predict_time_s</th>
      <th>speedup_vs_base</th>
      <th>auc</th>
      <th>pos_recall</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>brute</td>
      <td>0.020</td>
      <td>4.252</td>
      <td>1.00</td>
      <td>0.742155</td>
      <td>0.197473</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ball_tree</td>
      <td>0.308</td>
      <td>261.039</td>
      <td>0.07</td>
      <td>0.741822</td>
      <td>0.197806</td>
    </tr>
    <tr>
      <th>1</th>
      <td>kd_tree</td>
      <td>0.439</td>
      <td>19.352</td>
      <td>0.05</td>
      <td>0.741647</td>
      <td>0.197806</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejor tiempo de predicción: brute (4.252s)
</pre></div>
</div>
</div>
</div>
</section>
<section id="conclusion-de-la-seccion-3-el-impacto-de-la-dimensionalidad-en-knn">
<h2>Conclusión de la Sección 3: El Impacto de la Dimensionalidad en KNN<a class="headerlink" href="#conclusion-de-la-seccion-3-el-impacto-de-la-dimensionalidad-en-knn" title="Link to this heading">#</a></h2>
<p>Los resultados de esta sección <strong>validan de manera contundente la hipótesis inicial</strong>: en un espacio de tantas dimensiones, los algoritmos de búsqueda basados en árboles (<code class="docutils literal notranslate"><span class="pre">kd_tree</span></code>, <code class="docutils literal notranslate"><span class="pre">ball_tree</span></code>) no solo no ofrecen una ventaja de velocidad, sino que son <strong>drásticamente más lentos</strong> que una búsqueda de fuerza bruta (<code class="docutils literal notranslate"><span class="pre">brute-force</span></code>).</p>
<section id="id6">
<h3>Hallazgos Clave:<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">brute-force</span></code> es el Ganador en Velocidad:</strong></p>
<ul class="simple">
<li><p>El algoritmo <code class="docutils literal notranslate"><span class="pre">brute</span></code> completó las predicciones en <strong>~4.3 segundos</strong>.</p></li>
<li><p>En comparación, <code class="docutils literal notranslate"><span class="pre">kd_tree</span></code> fue <strong>más de 4 veces más lento</strong> (19.4 segundos).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ball_tree</span></code> fue el más lento de todos, tardando <strong>más de 4 minutos</strong> (261 segundos), lo que lo hace computacionalmente inviable para este problema.</p></li>
</ul>
</li>
<li><p><strong>El Costo del <code class="docutils literal notranslate"><span class="pre">fit</span></code>:</strong></p>
<ul class="simple">
<li><p>Se observa que el tiempo de <code class="docutils literal notranslate"><span class="pre">fit</span></code> para <code class="docutils literal notranslate"><span class="pre">kd_tree</span></code> y <code class="docutils literal notranslate"><span class="pre">ball_tree</span></code> es considerablemente mayor que el de <code class="docutils literal notranslate"><span class="pre">brute</span></code>, que simplemente almacena los datos. Este tiempo adicional de construcción no se ve compensado por una búsqueda más rápida.</p></li>
</ul>
</li>
<li><p><strong>Rendimiento Predictivo Idéntico:</strong></p>
<ul class="simple">
<li><p>Como era de esperar, todos los algoritmos producen resultados predictivos virtualmente idénticos (AUC ~0.742, F1 ~0.278), ya que encuentran los mismos vecinos. La diferencia es puramente de eficiencia computacional.</p></li>
</ul>
</li>
</ol>
</section>
<section id="id7">
<h3>Veredicto Final de la Sección<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<p>Para el problema de KNN en este dataset, la configuración óptima es <strong><code class="docutils literal notranslate"><span class="pre">algorithm='brute'</span></code></strong>. Es, por un margen muy amplio, la más rápida y eficiente. Para cualquier trabajo futuro de tuning de hiperparámetros en el modelo KNN, se utilizará esta configuración como base.</p>
<hr class="docutils" />
</section>
</section>
<section id="experimento-adicional-mitigando-la-maldicion-de-la-dimensionalidad-con-pca-knn">
<h2>Experimento Adicional: Mitigando la Maldición de la Dimensionalidad con PCA + KNN<a class="headerlink" href="#experimento-adicional-mitigando-la-maldicion-de-la-dimensionalidad-con-pca-knn" title="Link to this heading">#</a></h2>
<p>Los resultados de la Sección 3 demostraron concluyentemente que los algoritmos <code class="docutils literal notranslate"><span class="pre">kd_tree</span></code> y <code class="docutils literal notranslate"><span class="pre">ball_tree</span></code> son ineficientes en el espacio original de 16 dimensiones, un fenómeno atribuido a la «maldición de la dimensionalidad».</p>
<p>Esto nos lleva a una pregunta lógica: <strong>¿podemos encontrar un número de dimensiones más bajo en el que <code class="docutils literal notranslate"><span class="pre">kd_tree</span></code> y <code class="docutils literal notranslate"><span class="pre">ball_tree</span></code> recuperen su ventaja computacional?</strong></p>
<section id="id8">
<h3>Hipótesis<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<p>La hipótesis es que al reducir artificialmente la dimensionalidad de los datos, los algoritmos de búsqueda basados en árboles (<code class="docutils literal notranslate"><span class="pre">kd_tree</span></code>, <code class="docutils literal notranslate"><span class="pre">ball_tree</span></code>) eventualmente superarán en velocidad a la búsqueda de fuerza bruta (<code class="docutils literal notranslate"><span class="pre">brute</span></code>).</p>
</section>
<section id="metodologia">
<h3>Metodología<a class="headerlink" href="#metodologia" title="Link to this heading">#</a></h3>
<p>Para probar esta hipótesis, realizaremos un experimento adicional utilizando el <strong>Análisis de Componentes Principales (PCA)</strong>. Esta técnica nos permitirá proyectar los datos a un espacio de menor dimensionalidad, conservando la mayor cantidad de varianza posible.</p>
<p>Se evaluará el <strong>tiempo de predicción</strong> y el rendimiento de los tres algoritmos de KNN en versiones del dataset reducidas a <strong>12, 8 y 4 componentes principales</strong>. El objetivo es observar si existe un «punto de inflexión» dimensional donde la eficiencia de las estructuras de árbol se hace evidente. También se monitoreará el rendimiento predictivo (AUC, Recall), ya que la reducción de dimensionalidad puede implicar una pequeña pérdida de información.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Experimento adicional: PCA + KNN (¿mejora kd_tree / ball_tree?)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">=== Experimento Adicional: PCA + KNN ===&#39;</span><span class="p">)</span>
<span class="c1"># Reducimos a varias dimensiones y medimos predict time</span>
<span class="k">for</span> <span class="n">n_comp</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">]:</span>
    <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_comp</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
    <span class="n">Xtr_p</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">)</span>
    <span class="n">Xte_p</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-- PCA </span><span class="si">{</span><span class="n">n_comp</span><span class="si">}</span><span class="s2"> componentes (var_acum=</span><span class="si">{</span><span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">) --&quot;</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">algo</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;brute&#39;</span><span class="p">,</span><span class="s1">&#39;kd_tree&#39;</span><span class="p">,</span><span class="s1">&#39;ball_tree&#39;</span><span class="p">]:</span>
        <span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="n">algo</span><span class="p">)</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">();</span> <span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xtr_p</span><span class="p">,</span> <span class="n">y_train</span><span class="p">);</span> <span class="n">fit_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span><span class="o">-</span><span class="n">t0</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">();</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xte_p</span><span class="p">);</span> <span class="n">pred_t</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span><span class="o">-</span><span class="n">t1</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">roc_auc_score</span>
        <span class="c1"># AUC con distancias aproximadas (KNN no da proba salvo weights=&#39;distance&#39;)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">proba</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">Xte_p</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">proba</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">auc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">)</span>
        <span class="n">rep</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">output_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">recall1</span> <span class="o">=</span> <span class="n">rep</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;recall&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>
        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;algo&#39;</span><span class="p">:</span> <span class="n">algo</span><span class="p">,</span> <span class="s1">&#39;fit_s&#39;</span><span class="p">:</span> <span class="n">fit_t</span><span class="p">,</span> <span class="s1">&#39;pred_s&#39;</span><span class="p">:</span> <span class="n">pred_t</span><span class="p">,</span> <span class="s1">&#39;recall1&#39;</span><span class="p">:</span> <span class="n">recall1</span><span class="p">,</span> <span class="s1">&#39;auc&#39;</span><span class="p">:</span> <span class="n">auc</span><span class="p">})</span>
    <span class="n">disp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;pred_s&#39;</span><span class="p">)</span>
    <span class="n">disp</span><span class="p">[[</span><span class="s1">&#39;fit_s&#39;</span><span class="p">,</span><span class="s1">&#39;pred_s&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">disp</span><span class="p">[[</span><span class="s1">&#39;fit_s&#39;</span><span class="p">,</span><span class="s1">&#39;pred_s&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">disp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Experimento Adicional: PCA + KNN ===

-- PCA 4 componentes (var_acum=0.527) --
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>algo</th>
      <th>fit_s</th>
      <th>pred_s</th>
      <th>recall1</th>
      <th>auc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>kd_tree</td>
      <td>0.188</td>
      <td>1.127</td>
      <td>0.198471</td>
      <td>0.733468</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ball_tree</td>
      <td>0.120</td>
      <td>9.228</td>
      <td>0.198471</td>
      <td>0.733447</td>
    </tr>
    <tr>
      <th>0</th>
      <td>brute</td>
      <td>0.018</td>
      <td>9.711</td>
      <td>0.198803</td>
      <td>0.733569</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-- PCA 8 componentes (var_acum=0.769) --
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>algo</th>
      <th>fit_s</th>
      <th>pred_s</th>
      <th>recall1</th>
      <th>auc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>kd_tree</td>
      <td>0.182</td>
      <td>2.189</td>
      <td>0.189827</td>
      <td>0.735102</td>
    </tr>
    <tr>
      <th>0</th>
      <td>brute</td>
      <td>0.010</td>
      <td>4.198</td>
      <td>0.189827</td>
      <td>0.735753</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ball_tree</td>
      <td>0.128</td>
      <td>58.696</td>
      <td>0.189827</td>
      <td>0.735117</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-- PCA 12 componentes (var_acum=0.947) --
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>algo</th>
      <th>fit_s</th>
      <th>pred_s</th>
      <th>recall1</th>
      <th>auc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>kd_tree</td>
      <td>0.286</td>
      <td>4.791</td>
      <td>0.209109</td>
      <td>0.741869</td>
    </tr>
    <tr>
      <th>0</th>
      <td>brute</td>
      <td>0.013</td>
      <td>5.259</td>
      <td>0.209109</td>
      <td>0.742298</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ball_tree</td>
      <td>0.255</td>
      <td>116.284</td>
      <td>0.208777</td>
      <td>0.741863</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Conclusión rápida: si kd_tree/ball_tree no superan a brute incluso tras reducir a &lt; 10 dims, descartar definitivamente su uso.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion-del-experimento-adicional-pca-knn">
<h2>Conclusión del Experimento Adicional: PCA + KNN<a class="headerlink" href="#conclusion-del-experimento-adicional-pca-knn" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>La Dimensionalidad es el Factor Decisivo:</strong></p>
<ul class="simple">
<li><p><strong>Con 4 componentes:</strong> <code class="docutils literal notranslate"><span class="pre">kd_tree</span></code> es el claro ganador en velocidad, siendo <strong>más de 8 veces más rápido</strong> en la predicción que <code class="docutils literal notranslate"><span class="pre">brute-force</span></code>. Aquí, la estructura de árbol es extremadamente eficiente.</p></li>
<li><p><strong>Con 8 componentes:</strong> La ventaja de <code class="docutils literal notranslate"><span class="pre">kd_tree</span></code> se reduce significativamente. Ahora es solo <strong>aproximadamente 2 veces más rápido</strong> que <code class="docutils literal notranslate"><span class="pre">brute-force</span></code>.</p></li>
<li><p><strong>Con 12 componentes:</strong> El punto de inflexión es evidente. <code class="docutils literal notranslate"><span class="pre">kd_tree</span></code> es ahora <strong>solo marginalmente más rápido</strong> que <code class="docutils literal notranslate"><span class="pre">brute-force</span></code>. El costo de recorrer el árbol en un espacio de 12 dimensiones casi iguala el costo de una búsqueda exhaustiva.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">ball_tree</span></code> no es Competitivo:</strong> El algoritmo <code class="docutils literal notranslate"><span class="pre">ball_tree</span></code> solo mostró una ligera ventaja en el espacio de 4 dimensiones y se volvió drásticamente ineficiente a medida que aumentaba la dimensionalidad, confirmando que no es una opción viable para este dataset.</p></li>
<li><p><strong>El Trade-Off entre Velocidad y Rendimiento Predictivo:</strong></p>
<ul class="simple">
<li><p>La mayor ganancia en velocidad (con 4 componentes) viene a costa de una pérdida en el rendimiento predictivo (AUC de 0.733), ya que solo se conserva el 53% de la varianza de los datos.</p></li>
<li><p>El mejor rendimiento predictivo se alcanza con 12 componentes (AUC de 0.742), que es casi idéntico al del modelo original con 16 dimensiones. Sin embargo, en este punto, la ventaja de velocidad de <code class="docutils literal notranslate"><span class="pre">kd_tree</span></code> es casi nula.</p></li>
</ul>
</li>
</ol>
<section id="veredicto-final-del-experimento">
<h3>Veredicto Final del Experimento<a class="headerlink" href="#veredicto-final-del-experimento" title="Link to this heading">#</a></h3>
<p>El experimento fue un éxito rotundo al demostrar la teoría: <strong>la reducción de dimensionalidad sí restaura la eficiencia de los algoritmos de búsqueda basados en árboles</strong>.</p>
<p>Sin embargo, para este problema específico, la conclusión práctica de la Sección 3 se mantiene firme: dado que el mejor rendimiento predictivo se obtiene con una dimensionalidad alta (12 o 16), donde <code class="docutils literal notranslate"><span class="pre">brute-force</span></code> es igual o más rápido que sus alternativas, <strong>la configuración óptima para KNN sigue siendo <code class="docutils literal notranslate"><span class="pre">algorithm='brute'</span></code> sobre los datos originales</strong>. El pequeño o nulo beneficio de velocidad de <code class="docutils literal notranslate"><span class="pre">kd_tree</span></code> en el espacio de alta performance no justifica la complejidad añadida de un paso de PCA.</p>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="seccion-4-optimizacion-de-naive-bayes-con-entrenamiento-incremental-partial-fit">
<h1>Sección 4: Optimización de Naive Bayes con Entrenamiento Incremental (<code class="docutils literal notranslate"><span class="pre">partial_fit</span></code>)<a class="headerlink" href="#seccion-4-optimizacion-de-naive-bayes-con-entrenamiento-incremental-partial-fit" title="Link to this heading">#</a></h1>
<p>A diferencia de otros modelos, la principal optimización para <code class="docutils literal notranslate"><span class="pre">Naive</span> <span class="pre">Bayes</span></code> no se centra en acelerar el entrenamiento en datasets que caben en memoria, ya que su método <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> es de por sí extremadamente rápido (generalmente implica una sola pasada por los datos para calcular medias y desviaciones estándar).</p>
<p>En cambio, la característica clave de <code class="docutils literal notranslate"><span class="pre">Naive</span> <span class="pre">Bayes</span></code> es su capacidad para realizar <strong>entrenamiento incremental</strong> o <strong>por lotes</strong> a través del método <code class="docutils literal notranslate"><span class="pre">.partial_fit()</span></code>.</p>
<section id="objetivo-y-relevancia">
<h2>Objetivo y Relevancia<a class="headerlink" href="#objetivo-y-relevancia" title="Link to this heading">#</a></h2>
<p>El objetivo de esta sección es demostrar la viabilidad del entrenamiento por lotes. Esta técnica es <strong>fundamental para escenarios de Big Data</strong>, donde el conjunto de datos es demasiado grande para ser cargado en la RAM de una sola vez. Permite que el modelo aprenda de los datos «trozo a trozo».</p>
</section>
<section id="id9">
<h2>Hipótesis<a class="headerlink" href="#id9" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Rendimiento Predictivo:</strong> Se espera que el modelo entrenado con <code class="docutils literal notranslate"><span class="pre">.partial_fit()</span></code> alcance un rendimiento predictivo <strong>idéntico o casi idéntico</strong> al del modelo entrenado con <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> sobre todos los datos.</p></li>
<li><p><strong>Tiempo de Entrenamiento:</strong> El tiempo total de entrenamiento con <code class="docutils literal notranslate"><span class="pre">.partial_fit()</span></code> podría ser ligeramente superior al de un <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> único debido al overhead de las múltiples llamadas al método.</p></li>
</ul>
</section>
<section id="id10">
<h2>Experimentos<a class="headerlink" href="#id10" title="Link to this heading">#</a></h2>
<p>Se compararán dos escenarios:</p>
<ol class="arabic simple">
<li><p><strong>Caso Base:</strong> <code class="docutils literal notranslate"><span class="pre">GaussianNB</span></code> entrenado con el método <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> tradicional sobre todo el conjunto de entrenamiento.</p></li>
<li><p><strong>Caso Optimizado:</strong> <code class="docutils literal notranslate"><span class="pre">GaussianNB</span></code> entrenado iterativamente con el método <code class="docutils literal notranslate"><span class="pre">.partial_fit()</span></code> sobre lotes (batches) de 10,000 muestras.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">=== Sección 4: GaussianNB (full vs incremental) ===&#39;</span><span class="p">)</span>

<span class="c1"># Base</span>
<span class="n">gnb_base</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">gnb_base</span><span class="p">,</span> <span class="s1">&#39;GaussianNB&#39;</span><span class="p">,</span> <span class="s1">&#39;full_fit&#39;</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">base_key</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;GaussianNB&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>

<span class="c1"># partial_fit</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="n">X_train_scaled</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">start_fit</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="n">gnb_partial</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
    <span class="n">end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="n">Xb</span> <span class="o">=</span> <span class="n">X_train_scaled</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
    <span class="n">yb</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">gnb_partial</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gnb_partial</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">(</span><span class="n">Xb</span><span class="p">,</span> <span class="n">yb</span><span class="p">)</span>
<span class="n">fit_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_fit</span>

<span class="c1"># Predict + métricas usando helper (para consistencia reaplicamos parte de lógica)</span>
<span class="n">start_pred</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">gnb_partial</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>
<span class="n">predict_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_pred</span>
<span class="n">proba</span> <span class="o">=</span> <span class="n">gnb_partial</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">proba</span><span class="p">)</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">output_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">zero_division</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">recall1</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;recall&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>
<span class="n">precision1</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>
<span class="n">f1_1</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;f1-score&#39;</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">))</span>
<span class="n">base_t</span> <span class="o">=</span> <span class="n">base_times</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="s1">&#39;GaussianNB&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>
<span class="n">speedup</span> <span class="o">=</span> <span class="n">base_t</span> <span class="o">/</span> <span class="n">fit_time</span> <span class="k">if</span> <span class="n">base_t</span> <span class="k">else</span> <span class="kc">None</span>
<span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;modelo&#39;</span><span class="p">:</span><span class="s1">&#39;GaussianNB&#39;</span><span class="p">,</span><span class="s1">&#39;configuracion&#39;</span><span class="p">:</span><span class="s1">&#39;partial_fit&#39;</span><span class="p">,</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">:</span><span class="n">fit_time</span><span class="p">,</span><span class="s1">&#39;predict_time_s&#39;</span><span class="p">:</span><span class="n">predict_time</span><span class="p">,</span><span class="s1">&#39;auc&#39;</span><span class="p">:</span><span class="n">auc</span><span class="p">,</span><span class="s1">&#39;pos_recall&#39;</span><span class="p">:</span><span class="n">recall1</span><span class="p">,</span><span class="s1">&#39;pos_precision&#39;</span><span class="p">:</span><span class="n">precision1</span><span class="p">,</span><span class="s1">&#39;pos_f1&#39;</span><span class="p">:</span><span class="n">f1_1</span><span class="p">,</span><span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">:</span><span class="n">speedup</span><span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;→ GaussianNB [partial_fit] fit=</span><span class="si">{</span><span class="n">fmt_seconds</span><span class="p">(</span><span class="n">fit_time</span><span class="p">)</span><span class="si">}</span><span class="s2"> pred=</span><span class="si">{</span><span class="n">fmt_seconds</span><span class="p">(</span><span class="n">predict_time</span><span class="p">)</span><span class="si">}</span><span class="s2"> AUC=</span><span class="si">{</span><span class="n">auc</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> R1=</span><span class="si">{</span><span class="n">recall1</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">sec4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;modelo&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;GaussianNB&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Resumen Sección 4:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">sec4</span><span class="p">[[</span><span class="s1">&#39;configuracion&#39;</span><span class="p">,</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">,</span><span class="s1">&#39;predict_time_s&#39;</span><span class="p">,</span><span class="s1">&#39;auc&#39;</span><span class="p">,</span><span class="s1">&#39;pos_recall&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Sección 4: GaussianNB (full vs incremental) ===
→ GaussianNB [full_fit] fit=99.9 ms pred=23.5 ms AUC=0.8321 R1=0.5625 F1=0.4139 | speedup=1.00x
→ GaussianNB [partial_fit] fit=53.4 ms pred=27.9 ms AUC=0.8321 R1=0.5625

Resumen Sección 4:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>configuracion</th>
      <th>fit_time_s</th>
      <th>predict_time_s</th>
      <th>auc</th>
      <th>pos_recall</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>partial_fit</td>
      <td>0.0534</td>
      <td>0.0279</td>
      <td>0.8321</td>
      <td>0.5625</td>
    </tr>
    <tr>
      <th>0</th>
      <td>full_fit</td>
      <td>0.0999</td>
      <td>0.0235</td>
      <td>0.8321</td>
      <td>0.5625</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<hr class="docutils" />
</section>
<section id="conclusion-de-la-seccion-4-entrenamiento-incremental-con-naive-bayes">
<h2>Conclusión de la Sección 4: Entrenamiento Incremental con Naive Bayes<a class="headerlink" href="#conclusion-de-la-seccion-4-entrenamiento-incremental-con-naive-bayes" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Rendimiento Predictivo Idéntico Confirmado:</strong></p>
<ul class="simple">
<li><p>Como se esperaba, ambos métodos de entrenamiento produjeron un modelo final con un rendimiento predictivo <strong>exactamente idéntico</strong> (AUC de 0.8321 y Recall de 0.5625). Esto confirma que <code class="docutils literal notranslate"><span class="pre">partial_fit</span></code> es una técnica matemáticamente sólida que converge a la misma solución que el entrenamiento completo.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">partial_fit</span></code> fue Más Rápido:</strong></p>
<ul class="simple">
<li><p>El entrenamiento por lotes con <code class="docutils literal notranslate"><span class="pre">partial_fit</span></code> fue <strong>aproximadamente un 35% más rápido</strong> que el método <code class="docutils literal notranslate"><span class="pre">fit</span></code> único (42 ms vs. 64 ms).</p></li>
<li><p>El tiempo de predicción también fue notablemente más rápido en el modelo entrenado incrementalmente.</p></li>
</ul>
</li>
</ol>
<section id="analisis-e-interpretacion-eficiencia-de-la-gestion-de-memoria">
<h3>Análisis e Interpretación: Eficiencia de la Gestión de Memoria<a class="headerlink" href="#analisis-e-interpretacion-eficiencia-de-la-gestion-de-memoria" title="Link to this heading">#</a></h3>
<p>El hecho de que el entrenamiento por lotes fuera más rápido, se puede explicar por la eficiencia en la gestión de la memoria y el caché.</p>
<p>Al procesar los datos en «trozos» más pequeños (batches de 10,000 muestras), el algoritmo esta operando de manera más eficiente dentro de los niveles de caché del procesador. En lugar de cargar y procesar un array de NumPy muy grande de una sola vez, las operaciones se realizan sobre bloques de memoria más pequeños y manejables, lo que puede reducir la latencia y resultar en un tiempo de ejecución total menor, a pesar del overhead del bucle de Python.</p>
</section>
<section id="id11">
<h3>Veredicto Final de la Sección<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<p>Este hallazgo subraya una doble ventaja de <code class="docutils literal notranslate"><span class="pre">partial_fit</span></code>:</p>
<ol class="arabic simple">
<li><p><strong>Permite la escalabilidad a Big Data</strong>, que es su propósito principal.</p></li>
<li><p><strong>Puede ofrecer beneficios de velocidad</strong> incluso en datasets que sí caben en memoria, probablemente debido a una mejor localidad de los datos y eficiencia del caché.</p></li>
</ol>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="seccion-5-optimizacion-de-svm-con-aproximaciones-escalables">
<h1>Sección 5: Optimización de SVM con Aproximaciones Escalables<a class="headerlink" href="#seccion-5-optimizacion-de-svm-con-aproximaciones-escalables" title="Link to this heading">#</a></h1>
<p>Los <strong>Support Vector Machines (SVM)</strong>, especialmente con kernels no lineales como el RBF, son modelos teóricamente muy potentes. Sin embargo, su principal desventaja es su pobre escalabilidad: el algoritmo <code class="docutils literal notranslate"><span class="pre">SVC</span></code> de <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> tiene una complejidad computacional de al menos <strong>O(n²)</strong>, lo que lo hace computacionalmente costoso para datasets gradnes. Por esta razón, el <code class="docutils literal notranslate"><span class="pre">SVC</span></code> estándar se omite deliberadamente en este análisis.</p>
<p>En esta sección, el objetivo es evaluar varias <strong>aproximaciones y alternativas escalables</strong> que buscan ofrecer el poder de los SVM.</p>
<section id="id12">
<h2>Hipótesis<a class="headerlink" href="#id12" title="Link to this heading">#</a></h2>
<p>Se espera que todas las alternativas sean más rápidas que un <code class="docutils literal notranslate"><span class="pre">SVC</span></code> teórico. La comparación interesante radicará en el trade-off entre la velocidad de entrenamiento y la capacidad predictiva de cada aproximación.</p>
</section>
<section id="id13">
<h2>Experimentos<a class="headerlink" href="#id13" title="Link to this heading">#</a></h2>
<p>Se compararán tres estrategias de optimización distintas:</p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">SGDClassifier</span></code> (Aproximación por Gradiente):</strong></p>
<ul class="simple">
<li><p>Implementa un SVM lineal utilizando Descenso de Gradiente (<code class="docutils literal notranslate"><span class="pre">loss='hinge'</span></code>). Es un método de aproximación extremadamente rápido y escalable, ideal para datasets muy grandes, aunque puede ser menos preciso que un solver exacto.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LinearSVC</span></code> (Implementación Optimizada):</strong></p>
<ul class="simple">
<li><p>Es la implementación de <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> altamente optimizada (basada en <code class="docutils literal notranslate"><span class="pre">liblinear</span></code>) para SVMs <strong>estrictamente lineales</strong>. Es mucho más rápida que <code class="docutils literal notranslate"><span class="pre">SVC(kernel='linear')</span></code> y sirve como nuestro baseline de rendimiento para el caso lineal exacto. La que hemos usado hasta ahora.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">RBFSampler</span></code> + <code class="docutils literal notranslate"><span class="pre">LinearSVC</span></code> (Aproximación de Kernel):</strong></p>
<ul class="simple">
<li><p>Esta es la técnica más avanzada. Utiliza «Random Fourier Features» (<code class="docutils literal notranslate"><span class="pre">RBFSampler</span></code>) para crear una transformación explícita de las características. La magia de este método es que, en este nuevo espacio de características, un <strong>modelo lineal</strong> (<code class="docutils literal notranslate"><span class="pre">LinearSVC</span></code>) puede <strong>aproximar el comportamiento de un potente SVM no lineal con kernel RBF</strong>. Esto nos permite obtener el poder de un kernel no lineal con la velocidad de un modelo lineal.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">=== Sección 5: SVM Aproximaciones ===&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Referencia SVC(rbf) omitida (coste O(n^2)).&#39;</span><span class="p">)</span>

<span class="c1"># SGDClassifier</span>
<span class="n">sgd</span> <span class="o">=</span> <span class="n">SGDClassifier</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;hinge&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">sgd</span><span class="p">,</span> <span class="s1">&#39;SVM_approx&#39;</span><span class="p">,</span> <span class="s1">&#39;SGD_hinge&#39;</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">base_key</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;SVM_approx&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>

<span class="c1"># LinearSVC</span>
<span class="n">lsvc</span> <span class="o">=</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">lsvc</span><span class="p">,</span> <span class="s1">&#39;SVM_approx&#39;</span><span class="p">,</span> <span class="s1">&#39;LinearSVC&#39;</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">base_key</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;SVM_approx&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>

<span class="c1"># RFF + LinearSVC</span>
<span class="n">rff_svc</span> <span class="o">=</span> <span class="n">SkPipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;rff&#39;</span><span class="p">,</span> <span class="n">RBFSampler</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">&#39;svc&#39;</span><span class="p">,</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">RANDOM_STATE</span><span class="p">))</span>
<span class="p">])</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">rff_svc</span><span class="p">,</span> <span class="s1">&#39;SVM_approx&#39;</span><span class="p">,</span> <span class="s1">&#39;RFF_LinearSVC&#39;</span><span class="p">,</span> <span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test_scaled</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">base_key</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;SVM_approx&#39;</span><span class="p">,</span><span class="s1">&#39;base&#39;</span><span class="p">))</span>

<span class="n">sec5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;modelo&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;SVM_approx&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Resumen Sección 5:&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">sec5</span><span class="p">[[</span><span class="s1">&#39;configuracion&#39;</span><span class="p">,</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">,</span><span class="s1">&#39;predict_time_s&#39;</span><span class="p">,</span><span class="s1">&#39;auc&#39;</span><span class="p">,</span><span class="s1">&#39;pos_recall&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== Sección 5: SVM Aproximaciones ===
Referencia SVC(rbf) omitida (coste O(n^2)).
→ SVM_approx [SGD_hinge] fit=571.4 ms pred=34.7 ms AUC=0.7728 R1=0.0755 F1=0.1343 | speedup=1.00x
→ SVM_approx [LinearSVC] fit=742.8 ms pred=4.7 ms AUC=0.8567 R1=0.1124 F1=0.1893 | speedup=0.77x
→ SVM_approx [RFF_LinearSVC] fit=9.528 s pred=539.9 ms AUC=0.7573 R1=0.0 F1=0.0 | speedup=0.06x

Resumen Sección 5:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>configuracion</th>
      <th>fit_time_s</th>
      <th>predict_time_s</th>
      <th>auc</th>
      <th>pos_recall</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>SGD_hinge</td>
      <td>0.5714</td>
      <td>0.0347</td>
      <td>0.7728</td>
      <td>0.0755</td>
    </tr>
    <tr>
      <th>1</th>
      <td>LinearSVC</td>
      <td>0.7428</td>
      <td>0.0047</td>
      <td>0.8567</td>
      <td>0.1124</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RFF_LinearSVC</td>
      <td>9.5284</td>
      <td>0.5399</td>
      <td>0.7573</td>
      <td>0.0000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<hr class="docutils" />
</section>
<section id="conclusion-de-la-seccion-5-analisis-de-aproximaciones-de-svm">
<h2>Conclusión de la Sección 5: Análisis de Aproximaciones de SVM<a class="headerlink" href="#conclusion-de-la-seccion-5-analisis-de-aproximaciones-de-svm" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LinearSVC</span></code> es el Campeón Indiscutible:</strong></p>
<ul class="simple">
<li><p><strong>Rendimiento:</strong> <code class="docutils literal notranslate"><span class="pre">LinearSVC</span></code> alcanzó un <strong>AUC de 0.8567</strong>, un rendimiento excelente que lo sitúa al nivel de los mejores modelos del benchmark como XGBoost.</p></li>
<li><p><strong>Velocidad:</strong> Su tiempo de entrenamiento fue extremadamente rápido, completándose en solo <strong>~458 milisegundos</strong>.</p></li>
<li><p><strong>Conclusión:</strong> Esto confirma que <code class="docutils literal notranslate"><span class="pre">LinearSVC</span></code> es la implementación de SVM lineal por defecto, ofreciendo una combinación casi imbatible de velocidad y precisión para problemas que tienen una fuerte estructura lineal, como el nuestro.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">SGDClassifier</span></code> es Rápido, pero Menos Preciso:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SGDClassifier</span></code> fue el más rápido en entrenar (~433 ms).</p></li>
<li><p>Sin embargo, esta velocidad vino con un costo significativo en el rendimiento: su <strong>AUC fue de solo 0.7728</strong>, muy por debajo de <code class="docutils literal notranslate"><span class="pre">LinearSVC</span></code>. Esto indica que su aproximación por descenso de gradiente no logró converger a una solución tan buena como la que encontró el solver exacto de <code class="docutils literal notranslate"><span class="pre">liblinear</span></code> (usado por <code class="docutils literal notranslate"><span class="pre">LinearSVC</span></code>).</p></li>
</ul>
</li>
<li><p><strong>La Aproximación de Kernel (<code class="docutils literal notranslate"><span class="pre">RBFSampler</span></code>) Falla en este Contexto:</strong></p>
<ul class="simple">
<li><p>Este fue el hallazgo más dramático. La combinación <code class="docutils literal notranslate"><span class="pre">RBFSampler</span></code> + <code class="docutils literal notranslate"><span class="pre">LinearSVC</span></code>, que teóricamente aproxima un potente kernel RBF, <strong>falló por completo en la práctica</strong>.</p></li>
<li><p>Su <code class="docutils literal notranslate"><span class="pre">recall</span></code> y <code class="docutils literal notranslate"><span class="pre">F1-Score</span></code> para la clase positiva fueron <strong>cero</strong>, lo que significa que el modelo no fue capaz de identificar ni un solo caso de impago. Además, fue con diferencia el método más lento en entrenar (~8.3 segundos).</p></li>
<li><p><strong>Análisis:</strong> Este fracaso puede deberse a múltiples factores. <code class="docutils literal notranslate"><span class="pre">RBFSampler</span></code> tiene hiperparámetros clave (<code class="docutils literal notranslate"><span class="pre">gamma</span></code>, <code class="docutils literal notranslate"><span class="pre">n_components</span></code>) que son muy sensibles y requieren un tuning cuidadoso. Con los valores por defecto, la transformación del espacio de características no fue útil y, de hecho, parece haber destruido la señal lineal que <code class="docutils literal notranslate"><span class="pre">LinearSVC</span></code> podía capturar por sí solo.</p></li>
</ul>
</li>
</ol>
<section id="id14">
<h3>Veredicto Final de la Sección<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<p>El experimento demuestra de manera concluyente que, para este problema:</p>
<ul class="simple">
<li><p>La aproximación de kernel RBF con <code class="docutils literal notranslate"><span class="pre">RBFSampler</span></code> <strong>no es una estrategia viable sin un tuning exhaustivo</strong> y, por lo tanto, se descarta por ahora.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SGDClassifier</span></code> es una alternativa ultrarrápida, pero su pérdida de precisión la hace menos atractiva en comparación con otras opciones.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LinearSVC</span></code> se consolida como la implementación de SVM óptima</strong>. Ofrece un rendimiento predictivo de primer nivel con una velocidad de entrenamiento excepcional, superando a todas las demás aproximaciones evaluadas. Será el representante de la familia SVM en las fases finales del proyecto.</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="seccion-6-tabla-resumen-analisis-visual-y-conclusiones">
<h1>Sección 6: Tabla Resumen, Análisis Visual y Conclusiones<a class="headerlink" href="#seccion-6-tabla-resumen-analisis-visual-y-conclusiones" title="Link to this heading">#</a></h1>
<p>Ademas de realizar la tabla comparativa final se han desarrollado una serie de visualizaciones avanzadas. El objetivo es analizar visualmente los trade-offs entre la <strong>velocidad computacional</strong> y el <strong>rendimiento predictivo</strong> de cada técnica de optimización.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Resumen final consolidado con métricas derivadas</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="n">res_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># Calcular speedup% respecto a la configuración base dentro de cada modelo</span>
<span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;speedup_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Ranking por modelo según fit_time</span>
<span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;rank_fit_model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;modelo&#39;</span><span class="p">)[</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;dense&#39;</span><span class="p">)</span>
<span class="c1"># Mejor AUC por modelo para delta</span>
<span class="n">best_auc</span> <span class="o">=</span> <span class="n">res_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;modelo&#39;</span><span class="p">)[</span><span class="s1">&#39;auc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;max&#39;</span><span class="p">)</span>
<span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;delta_auc_vs_best&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res_df</span><span class="p">[</span><span class="s1">&#39;auc&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">best_auc</span>

<span class="n">cols_disp</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;modelo&#39;</span><span class="p">,</span><span class="s1">&#39;configuracion&#39;</span><span class="p">,</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">,</span><span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">,</span><span class="s1">&#39;speedup_pct&#39;</span><span class="p">,</span><span class="s1">&#39;predict_time_s&#39;</span><span class="p">,</span><span class="s1">&#39;auc&#39;</span><span class="p">,</span><span class="s1">&#39;delta_auc_vs_best&#39;</span><span class="p">,</span><span class="s1">&#39;pos_recall&#39;</span><span class="p">]</span>
<span class="n">res_show</span> <span class="o">=</span> <span class="n">res_df</span><span class="p">[</span><span class="n">cols_disp</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">res_show</span> <span class="o">=</span> <span class="n">res_show</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s1">&#39;modelo&#39;</span><span class="p">,</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">])</span>
<span class="n">res_show</span> <span class="o">=</span> <span class="n">res_show</span><span class="o">.</span><span class="n">round</span><span class="p">({</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;predict_time_s&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;speedup_pct&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;auc&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;delta_auc_vs_best&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;pos_recall&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">})</span>

<span class="n">summary_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">REPORTS_DIR</span><span class="p">,</span> <span class="s1">&#39;optimizacion_computacional_summary_refactor.csv&#39;</span><span class="p">)</span>
<span class="n">res_show</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">summary_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;✓ Resumen guardado en </span><span class="si">{</span><span class="n">summary_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="n">res_show</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✓ Resumen guardado en C:\MachineLearningPG\reports\optimizacion_computacional_summary_refactor.csv
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>modelo</th>
      <th>configuracion</th>
      <th>fit_time_s</th>
      <th>speedup_vs_base</th>
      <th>speedup_pct</th>
      <th>predict_time_s</th>
      <th>auc</th>
      <th>delta_auc_vs_best</th>
      <th>pos_recall</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>GaussianNB</td>
      <td>partial_fit</td>
      <td>0.053</td>
      <td>1.87</td>
      <td>86.9</td>
      <td>0.028</td>
      <td>0.8321</td>
      <td>0.0000</td>
      <td>0.5625</td>
    </tr>
    <tr>
      <th>12</th>
      <td>GaussianNB</td>
      <td>full_fit</td>
      <td>0.100</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>0.023</td>
      <td>0.8321</td>
      <td>0.0000</td>
      <td>0.5625</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Logistic_L1</td>
      <td>base_liblinear</td>
      <td>6.166</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>0.004</td>
      <td>0.8504</td>
      <td>-0.0000</td>
      <td>0.1606</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Logistic_L1</td>
      <td>saga</td>
      <td>19.585</td>
      <td>0.31</td>
      <td>-68.5</td>
      <td>0.004</td>
      <td>0.8504</td>
      <td>0.0000</td>
      <td>0.1606</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Logistic_L2</td>
      <td>base_lbfgs</td>
      <td>0.163</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>0.003</td>
      <td>0.8504</td>
      <td>0.0000</td>
      <td>0.1602</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Logistic_L2</td>
      <td>saga</td>
      <td>15.672</td>
      <td>0.01</td>
      <td>-99.0</td>
      <td>0.004</td>
      <td>0.8504</td>
      <td>-0.0000</td>
      <td>0.1606</td>
    </tr>
    <tr>
      <th>9</th>
      <td>SVM_approx</td>
      <td>SGD_hinge</td>
      <td>0.571</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>0.035</td>
      <td>0.7728</td>
      <td>-0.0839</td>
      <td>0.0755</td>
    </tr>
    <tr>
      <th>10</th>
      <td>SVM_approx</td>
      <td>LinearSVC</td>
      <td>0.743</td>
      <td>0.77</td>
      <td>-23.1</td>
      <td>0.005</td>
      <td>0.8567</td>
      <td>0.0000</td>
      <td>0.1124</td>
    </tr>
    <tr>
      <th>11</th>
      <td>SVM_approx</td>
      <td>RFF_LinearSVC</td>
      <td>9.528</td>
      <td>0.06</td>
      <td>-94.0</td>
      <td>0.540</td>
      <td>0.7573</td>
      <td>-0.0994</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>XGBoost</td>
      <td>hist_no_es</td>
      <td>0.710</td>
      <td>11.06</td>
      <td>1005.8</td>
      <td>0.035</td>
      <td>0.8537</td>
      <td>-0.0051</td>
      <td>0.7191</td>
    </tr>
    <tr>
      <th>7</th>
      <td>XGBoost</td>
      <td>hist</td>
      <td>0.852</td>
      <td>9.21</td>
      <td>821.0</td>
      <td>0.034</td>
      <td>0.8563</td>
      <td>-0.0025</td>
      <td>0.7274</td>
    </tr>
    <tr>
      <th>5</th>
      <td>XGBoost</td>
      <td>hist</td>
      <td>0.859</td>
      <td>9.14</td>
      <td>813.6</td>
      <td>0.034</td>
      <td>0.8563</td>
      <td>-0.0025</td>
      <td>0.7274</td>
    </tr>
    <tr>
      <th>6</th>
      <td>XGBoost</td>
      <td>exact</td>
      <td>7.614</td>
      <td>1.03</td>
      <td>3.1</td>
      <td>0.034</td>
      <td>0.8588</td>
      <td>0.0000</td>
      <td>0.7367</td>
    </tr>
    <tr>
      <th>4</th>
      <td>XGBoost</td>
      <td>exact</td>
      <td>7.847</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>0.040</td>
      <td>0.8588</td>
      <td>0.0000</td>
      <td>0.7367</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualizaciones avanzadas</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="c1"># Usamos el DataFrame consolidado res_df</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">res_df</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
    <span class="n">res_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="c1"># Normalizamos nombres para tagging base vs variante</span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_base</span><span class="p">(</span><span class="n">cfg</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="n">cfg</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;base&#39;</span><span class="p">,</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span><span class="s1">&#39;full_fit&#39;</span><span class="p">,</span><span class="s1">&#39;brute&#39;</span><span class="p">,</span><span class="s1">&#39;SGD_hinge&#39;</span><span class="p">])</span>
<span class="n">res_viz</span> <span class="o">=</span> <span class="n">res_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">res_viz</span><span class="p">[</span><span class="s1">&#39;is_base&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res_viz</span><span class="p">[</span><span class="s1">&#39;configuracion&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">is_base</span><span class="p">)</span>
<span class="n">res_viz</span><span class="p">[</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res_viz</span><span class="p">[</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">res_viz</span><span class="p">[</span><span class="s1">&#39;predict_time_s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">res_viz</span><span class="p">[</span><span class="s1">&#39;predict_time_s&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="c1"># Paleta roja</span>
<span class="n">base_color</span> <span class="o">=</span> <span class="s1">&#39;#b71c1c&#39;</span>     
<span class="n">opt_color</span> <span class="o">=</span> <span class="s1">&#39;#ef5350&#39;</span>      
<span class="n">accent_color</span> <span class="o">=</span> <span class="s1">&#39;#880e4f&#39;</span>  
<span class="n">bg_color</span> <span class="o">=</span> <span class="s1">&#39;#faf7f7&#39;</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_theme</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.facecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bg_color</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.facecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.edgecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#cccccc&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titleweight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;grid.color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;#e0e0e0&#39;</span>

<span class="c1"># --- Figura 1: Tiempos de entrenamiento (log) ---</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span>

<span class="n">order_models</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">res_viz</span><span class="p">[</span><span class="s1">&#39;modelo&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="c1"># Fit time (log)</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">order_models</span><span class="p">:</span>
    <span class="n">subset</span> <span class="o">=</span> <span class="n">res_viz</span><span class="p">[</span><span class="n">res_viz</span><span class="p">[</span><span class="s1">&#39;modelo&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">)</span>
    <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;configuracion&#39;</span><span class="p">]]</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">base_color</span> <span class="k">if</span> <span class="n">b</span> <span class="k">else</span> <span class="n">opt_color</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;is_base&#39;</span><span class="p">]]</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_labels</span><span class="p">,</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Tiempo Fit (s, escala log)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Tiempo de Entrenamiento (log)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

<span class="c1"># Predict time (log)</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">order_models</span><span class="p">:</span>
    <span class="n">subset</span> <span class="o">=</span> <span class="n">res_viz</span><span class="p">[</span><span class="n">res_viz</span><span class="p">[</span><span class="s1">&#39;modelo&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;predict_time_s&#39;</span><span class="p">)</span>
    <span class="n">y_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;configuracion&#39;</span><span class="p">]]</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">base_color</span> <span class="k">if</span> <span class="n">b</span> <span class="k">else</span> <span class="n">opt_color</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;is_base&#39;</span><span class="p">]]</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_labels</span><span class="p">,</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;predict_time_s&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Tiempo Predict (s, escala log)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Tiempo de Predicción (log)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>

<span class="c1"># Speedup vs AUC scatter</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">order_models</span><span class="p">:</span>
    <span class="n">subset</span> <span class="o">=</span> <span class="n">res_viz</span><span class="p">[</span><span class="n">res_viz</span><span class="p">[</span><span class="s1">&#39;modelo&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">m</span><span class="p">]</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">subset</span><span class="p">[</span><span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">],</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;auc&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">110</span><span class="p">,</span>
                <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="n">base_color</span> <span class="k">if</span> <span class="n">b</span> <span class="k">else</span> <span class="n">opt_color</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;is_base&#39;</span><span class="p">]],</span>
                <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;symlog&#39;</span><span class="p">,</span> <span class="n">linthresh</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Speedup vs base (fit)&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;AUC&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Speedup vs AUC&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">res_viz</span><span class="p">[</span><span class="s1">&#39;auc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="n">accent_color</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="n">a</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Optimización Computacional - Visión General&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.96</span><span class="p">])</span>
<span class="n">red_viz_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">REPORTS_DIR</span><span class="p">,</span> <span class="s1">&#39;optimizacion_visual_rojo.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">red_viz_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ Visualización roja guardada en: </span><span class="si">{</span><span class="n">red_viz_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- Figura 2: Heatmap de speedup ---</span>
<span class="n">heat_df</span> <span class="o">=</span> <span class="n">res_viz</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">heat_df</span><span class="p">[</span><span class="s1">&#39;speedup_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">heat_df</span><span class="p">[</span><span class="s1">&#39;speedup_vs_base&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">pivot</span> <span class="o">=</span> <span class="n">heat_df</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;modelo&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;configuracion&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;speedup_pct&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">pivot</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.1f&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="s1">&#39;Speedup %&#39;</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Heatmap Speedup % por Configuración&#39;</span><span class="p">)</span>
<span class="n">heat_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">REPORTS_DIR</span><span class="p">,</span> <span class="s1">&#39;heatmap_speedup.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">heat_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ Heatmap guardado en: </span><span class="si">{</span><span class="n">heat_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- Figura 3: Delta AUC vs Fit Time (trade-off) ---</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">order_models</span><span class="p">:</span>
    <span class="n">subset</span> <span class="o">=</span> <span class="n">res_viz</span><span class="p">[</span><span class="n">res_viz</span><span class="p">[</span><span class="s1">&#39;modelo&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">best_auc</span> <span class="o">=</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;auc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;delta_auc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;auc&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">best_auc</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">subset</span><span class="p">[</span><span class="s1">&#39;fit_time_s&#39;</span><span class="p">],</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;delta_auc&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span>
                <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="n">base_color</span> <span class="k">if</span> <span class="n">b</span> <span class="k">else</span> <span class="n">opt_color</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">subset</span><span class="p">[</span><span class="s1">&#39;is_base&#39;</span><span class="p">]],</span>
                <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">accent_color</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fit Time (s, log)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delta AUC vs mejor&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Trade-off: Tiempo vs Pérdida de AUC&#39;</span><span class="p">)</span>
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="c1"># Evitar duplicados</span>
<span class="n">uniq</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">handles</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">uniq</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">uniq</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">trade_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">REPORTS_DIR</span><span class="p">,</span> <span class="s1">&#39;tradeoff_tiempo_delta_auc.png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">trade_path</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ Trade-off guardado en: </span><span class="si">{</span><span class="n">trade_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/11fd78afdd917b1899a2a5e8980ab586134c0a97071bb4ce29ab62f383cb6e66.png" src="../_images/11fd78afdd917b1899a2a5e8980ab586134c0a97071bb4ce29ab62f383cb6e66.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✓ Visualización roja guardada en: C:\MachineLearningPG\reports\optimizacion_visual_rojo.png
</pre></div>
</div>
<img alt="../_images/e3b9e9b9e8c8e8406ff600387902fe80e0e4321484e748710764c5f66c693889.png" src="../_images/e3b9e9b9e8c8e8406ff600387902fe80e0e4321484e748710764c5f66c693889.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✓ Heatmap guardado en: C:\MachineLearningPG\reports\heatmap_speedup.png
</pre></div>
</div>
<img alt="../_images/7ffeaec2d00fabf22b4c07087feb63363d4edf5744bba2e256728d8319c1e24b.png" src="../_images/7ffeaec2d00fabf22b4c07087feb63363d4edf5744bba2e256728d8319c1e24b.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>✓ Trade-off guardado en: C:\MachineLearningPG\reports\tradeoff_tiempo_delta_auc.png
</pre></div>
</div>
</div>
</div>
<section id="conclusion-final">
<h2><strong>Conclusión Final</strong><a class="headerlink" href="#conclusion-final" title="Link to this heading">#</a></h2>
<p>Este notebook se propuso identificar las configuraciones computacionalmente más eficientes para cada modelo, con el objetivo de acelerar el entrenamiento sin sacrificar el rendimiento predictivo. Los resultados han sido reveladores, confirmando algunas hipótesis y refutando otras de manera concluyente.</p>
<section id="resumen-de-ganancias-de-velocidad">
<h3>Resumen de Ganancias de Velocidad<a class="headerlink" href="#resumen-de-ganancias-de-velocidad" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Modelo</p></th>
<th class="head text-left"><p>Optimización Aplicada</p></th>
<th class="head text-left"><p>Ganancia Estimada</p></th>
<th class="head text-left"><p>AUC Mantenido</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p><strong>Logistic Regression</strong></p></td>
<td class="text-left"><p>Solvers <code class="docutils literal notranslate"><span class="pre">lbfgs</span></code> / <code class="docutils literal notranslate"><span class="pre">liblinear</span></code></p></td>
<td class="text-left"><p><strong>~4x a 50x más rápido</strong> vs <code class="docutils literal notranslate"><span class="pre">saga</span></code></p></td>
<td class="text-left"><p>Sí (idéntico)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><strong>XGBoost</strong></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">tree_method='hist'</span></code> + early stopping</p></td>
<td class="text-left"><p><strong>~11x más rápido</strong></p></td>
<td class="text-left"><p>Sí (~equivalente)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><strong>KNN</strong></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">algorithm='brute'</span></code></p></td>
<td class="text-left"><p><strong>~4x a 60x más rápido</strong> (predict) vs árboles</p></td>
<td class="text-left"><p>Sí (idéntico)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p><strong>Naive Bayes</strong></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">partial_fit</span></code></p></td>
<td class="text-left"><p><strong>~1.5x más rápido</strong> y escalable</p></td>
<td class="text-left"><p>Sí (idéntico)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p><strong>SVM</strong></p></td>
<td class="text-left"><p><code class="docutils literal notranslate"><span class="pre">LinearSVC</span></code></p></td>
<td class="text-left"><p><strong>~18x más rápido</strong> vs RFF y más preciso</p></td>
<td class="text-left"><p>Sí (el mejor AUC)</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="configuraciones-optimizadas-para-notebook-06-tuning">
<h3>Configuraciones Optimizadas para Notebook 06 (Tuning)<a class="headerlink" href="#configuraciones-optimizadas-para-notebook-06-tuning" title="Link to this heading">#</a></h3>
<p>Con base en los resultados empíricos, las configuraciones <strong>base optimizadas</strong> que usaremos para el tuning de hiperparámetros son:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configuraciones ganadoras para la siguiente fase</span>
<span class="n">optimized_estimators</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Logistic_L2&#39;</span><span class="p">:</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">2000</span><span class="p">),</span>
    <span class="s1">&#39;Logistic_L1&#39;</span><span class="p">:</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">2000</span><span class="p">),</span>
    <span class="s1">&#39;XGBoost&#39;</span><span class="p">:</span> <span class="n">XGBClassifier</span><span class="p">(</span>
        <span class="n">tree_method</span><span class="o">=</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span>
        <span class="c1"># early_stopping_rounds se configurará en la fase de tuning</span>
    <span class="p">),</span>
    <span class="s1">&#39;KNN&#39;</span><span class="p">:</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;brute&#39;</span><span class="p">),</span>
    <span class="s1">&#39;LinearSVC&#39;</span><span class="p">:</span> <span class="n">LinearSVC</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
    <span class="c1"># GaussianNB no requiere tuning extenso y se puede mantener como referencia</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="proximos-pasos">
<h3>Próximos Pasos<a class="headerlink" href="#proximos-pasos" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Notebook 06</strong>: Tuning de hiperparámetros con <code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code> / <code class="docutils literal notranslate"><span class="pre">BayesSearchCV</span></code> / <code class="docutils literal notranslate"><span class="pre">Optuna</span></code> sobre los modelos y configuraciones optimizadas identificadas.</p></li>
</ol>
</section>
<hr class="docutils" />
<section id="lecciones-aprendidas">
<h3>Lecciones Aprendidas<a class="headerlink" href="#lecciones-aprendidas" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>La Teoría debe ser Validada Empíricamente:</strong> Los resultados de Regresión Logística y KNN demostraron que las optimizaciones teóricas para «grandes» escalas (<code class="docutils literal notranslate"><span class="pre">saga</span></code>, <code class="docutils literal notranslate"><span class="pre">kd_tree</span></code>) pueden ser contraproducentes en datasets de tamaño moderado. <strong>Siempre hay que medir.</strong></p></li>
<li><p><strong>El «Overhead» de la Escalabilidad es Real:</strong> La analogía con PySpark vs. scikit-learn se confirmó. Las herramientas diseñadas para una escala masiva (<code class="docutils literal notranslate"><span class="pre">saga</span></code>, <code class="docutils literal notranslate"><span class="pre">PySpark</span></code>) pueden ser más lentas en problemas que caben en la RAM debido a su costo computacional inherente.</p></li>
<li><p><strong>Conocer las Herramientas es Clave:</strong> <code class="docutils literal notranslate"><span class="pre">tree_method='hist'</span></code> en XGBoost es un claro ejemplo de un parámetro que ofrece una ganancia de velocidad masiva con un impacto mínimo en la precisión, convirtiéndolo en una opción casi obligatoria.</p></li>
<li><p><strong>La Escalabilidad Sigue Siendo un Valor:</strong> Aunque <code class="docutils literal notranslate"><span class="pre">partial_fit</span></code> en Naive Bayes fue inesperadamente más rápido, su valor principal sigue siendo la capacidad de entrenar en datasets que superan la memoria RAM, una característica crucial para la producción.</p></li>
<li><p><strong>Las Aproximaciones Tienen un Costo:</strong> El fracaso de <code class="docutils literal notranslate"><span class="pre">RBFSampler</span></code> y el menor rendimiento de <code class="docutils literal notranslate"><span class="pre">SGDClassifier</span></code> demuestran que las aproximaciones para acelerar modelos complejos como los SVMs deben ser evaluadas cuidadosamente, ya que a menudo implican un trade-off significativo con el rendimiento predictivo.</p></li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="04_balanceo_clases.html"
       title="página anterior">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">anterior</p>
        <p class="prev-next-title">04 - Técnicas de Balanceo de Clases</p>
      </div>
    </a>
    <a class="right-next"
       href="06_tuning_hiperparametros.html"
       title="siguiente página">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">siguiente</p>
        <p class="prev-next-title"><strong>06 — Tuning, Validación e Interpretabilidad</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenido
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">05 - Optimización Computacional</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-y-carga-de-datos">Setup y Carga de Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ejecucion-de-pruebas">Ejecución de Pruebas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#capacidades-de-la-funcion-evaluate-model">Capacidades de la Función <code class="docutils literal notranslate"><span class="pre">evaluate_model</span></code>:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#seccion-1-optimizacion-de-modelos-lineales-logistic-regression">Sección 1: Optimización de Modelos Lineales (Logistic Regression)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objetivo">Objetivo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hipotesis">Hipótesis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experimentos">Experimentos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-de-la-seccion-1-optimizacion-de-solvers-en-regresion-logistica">Conclusión de la Sección 1: Optimización de Solvers en Regresión Logística</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hallazgos-clave">Hallazgos Clave:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-e-interpretacion-el-overhead-de-la-escalabilidad">Análisis e Interpretación: El «Overhead» de la Escalabilidad</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#veredicto-final-de-la-seccion">Veredicto Final de la Sección</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#seccion-2-optimizacion-de-xgboost">Sección 2: Optimización de XGBoost</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tecnicas">Técnicas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Hipótesis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Experimentos</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-y-conclusion-de-la-seccion-2-optimizacion-de-xgboost">Análisis y Conclusión de la Sección 2: Optimización de XGBoost</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Hallazgos Clave:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Veredicto Final de la Sección</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#seccion-3-optimizacion-de-k-nearest-neighbors-knn">Sección 3: Optimización de K-Nearest Neighbors (KNN)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hipotesis-la-maldicion-de-la-dimensionalidad">Hipótesis: La Maldición de la Dimensionalidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Experimentos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-de-la-seccion-3-el-impacto-de-la-dimensionalidad-en-knn">Conclusión de la Sección 3: El Impacto de la Dimensionalidad en KNN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Hallazgos Clave:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Veredicto Final de la Sección</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#experimento-adicional-mitigando-la-maldicion-de-la-dimensionalidad-con-pca-knn">Experimento Adicional: Mitigando la Maldición de la Dimensionalidad con PCA + KNN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Hipótesis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodologia">Metodología</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-del-experimento-adicional-pca-knn">Conclusión del Experimento Adicional: PCA + KNN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#veredicto-final-del-experimento">Veredicto Final del Experimento</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#seccion-4-optimizacion-de-naive-bayes-con-entrenamiento-incremental-partial-fit">Sección 4: Optimización de Naive Bayes con Entrenamiento Incremental (<code class="docutils literal notranslate"><span class="pre">partial_fit</span></code>)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#objetivo-y-relevancia">Objetivo y Relevancia</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Hipótesis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Experimentos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-de-la-seccion-4-entrenamiento-incremental-con-naive-bayes">Conclusión de la Sección 4: Entrenamiento Incremental con Naive Bayes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-e-interpretacion-eficiencia-de-la-gestion-de-memoria">Análisis e Interpretación: Eficiencia de la Gestión de Memoria</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Veredicto Final de la Sección</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#seccion-5-optimizacion-de-svm-con-aproximaciones-escalables">Sección 5: Optimización de SVM con Aproximaciones Escalables</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Hipótesis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Experimentos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-de-la-seccion-5-analisis-de-aproximaciones-de-svm">Conclusión de la Sección 5: Análisis de Aproximaciones de SVM</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Veredicto Final de la Sección</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#seccion-6-tabla-resumen-analisis-visual-y-conclusiones">Sección 6: Tabla Resumen, Análisis Visual y Conclusiones</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion-final"><strong>Conclusión Final</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#resumen-de-ganancias-de-velocidad">Resumen de Ganancias de Velocidad</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuraciones-optimizadas-para-notebook-06-tuning">Configuraciones Optimizadas para Notebook 06 (Tuning)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proximos-pasos">Próximos Pasos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lecciones-aprendidas">Lecciones Aprendidas</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Por Andrés España | Omar Medina
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  © 2025 Andrés España | Universidad del Norte
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>